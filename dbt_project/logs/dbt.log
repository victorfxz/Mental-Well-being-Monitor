[0m01:00:37.444096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F43C4E0B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F43D0C96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F43D0C8110>]}


============================== 01:00:37.503341 | 78911ea0-6a22-4bbf-948e-a8d381edf2bf ==============================
[0m01:00:37.503341 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:00:37.504053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:39.027979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78911ea0-6a22-4bbf-948e-a8d381edf2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F43D26E840>]}
[0m01:00:39.216157 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:00:39.216911 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:00:39.235681 [debug] [MainThread]: Command `dbt deps` succeeded at 01:00:39.218454 after 2.03 seconds
[0m01:00:39.235681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F43CE72060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F43707F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F43C085730>]}
[0m01:00:39.236684 [debug] [MainThread]: Flushing usage events
[0m01:01:21.579255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D9CB5E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D6CF6D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D6C9DF40>]}


============================== 01:01:21.583245 | 0c54b200-a6dc-4038-bea0-658775eda4ab ==============================
[0m01:01:21.583245 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:01:21.584914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:01:23.054410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c54b200-a6dc-4038-bea0-658775eda4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DA726030>]}
[0m01:01:23.210965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c54b200-a6dc-4038-bea0-658775eda4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D9DA2750>]}
[0m01:01:23.251680 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:01:23.265853 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:01:23.266849 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:01:23.267813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c54b200-a6dc-4038-bea0-658775eda4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DA735A30>]}
[0m01:01:25.518938 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:01:25.519937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c54b200-a6dc-4038-bea0-658775eda4ab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DBB507A0>]}
[0m01:01:26.005798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c54b200-a6dc-4038-bea0-658775eda4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DBB94A70>]}
[0m01:01:26.258485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c54b200-a6dc-4038-bea0-658775eda4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DBBF20F0>]}
[0m01:01:26.259484 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m01:01:26.259898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c54b200-a6dc-4038-bea0-658775eda4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DBAEDA60>]}
[0m01:01:26.263577 [info ] [MainThread]: 
[0m01:01:26.264578 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:01:26.272928 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health'
[0m01:01:27.183744 [debug] [ThreadPool]: Using duckdb connection "list_mental_health"
[0m01:01:27.184741 [debug] [ThreadPool]: On list_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"mental_health"'
    
  
  
[0m01:01:27.184741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:27.520344 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"mental_health"'
    
  
  
[0m01:01:27.520344 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:01:27.522339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:27.522339 [debug] [MainThread]: Connection 'list_mental_health' was properly closed.
[0m01:01:27.523376 [info ] [MainThread]: 
[0m01:01:27.523376 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m01:01:27.524472 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\users\admin\downloads\mental-health-de-zoomcamp\dbt_project\..\data\duckdb\mental_health.db": The system cannot find the path specified.
  
[0m01:01:27.526277 [debug] [MainThread]: Command `dbt run` failed at 01:01:27.525277 after 6.12 seconds
[0m01:01:27.526277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D9C483B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DBD6BE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DBB5C230>]}
[0m01:01:27.527274 [debug] [MainThread]: Flushing usage events
[0m01:02:19.997555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FAB38E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FD12A1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FD128680>]}


============================== 01:02:20.002545 | 6221188c-c0e6-43b7-9d77-fec8996ee520 ==============================
[0m01:02:20.002545 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:02:20.003169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:02:20.502578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6221188c-c0e6-43b7-9d77-fec8996ee520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FD6D6840>]}
[0m01:02:20.655559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6221188c-c0e6-43b7-9d77-fec8996ee520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FACAFE00>]}
[0m01:02:20.732534 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:02:20.744495 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:02:20.983537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:20.984535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:21.049468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6221188c-c0e6-43b7-9d77-fec8996ee520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FD926810>]}
[0m01:02:21.322513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6221188c-c0e6-43b7-9d77-fec8996ee520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FEC68A40>]}
[0m01:02:21.322513 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m01:02:21.323825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6221188c-c0e6-43b7-9d77-fec8996ee520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FD7F7E60>]}
[0m01:02:21.326822 [info ] [MainThread]: 
[0m01:02:21.328363 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:02:21.337838 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m01:02:21.467695 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m01:02:21.468692 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m01:02:21.468692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:21.475786 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m01:02:21.476787 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:02:21.477766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:21.477766 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m01:02:21.478805 [info ] [MainThread]: 
[0m01:02:21.478805 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m01:02:21.480273 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "c:\users\admin\downloads\mental-health-de-zoomcamp\dbt_project\..\data\duckdb\mental_health.db": The system cannot find the path specified.
  
[0m01:02:21.481276 [debug] [MainThread]: Command `dbt test` failed at 01:02:21.481276 after 1.68 seconds
[0m01:02:21.482275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FD616F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FEC9D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FD803E00>]}
[0m01:02:21.482275 [debug] [MainThread]: Flushing usage events
[0m01:15:46.537867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002521412EAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252143E23C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252143E3890>]}


============================== 01:15:46.542854 | 223be3d3-08b4-4490-bf92-be5e0ca68453 ==============================
[0m01:15:46.542854 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:15:46.544395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:15:46.845021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '223be3d3-08b4-4490-bf92-be5e0ca68453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025213CE2990>]}
[0m01:15:46.876262 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:15:46.877896 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:15:46.879417 [debug] [MainThread]: Command `dbt deps` succeeded at 01:15:46.878416 after 0.56 seconds
[0m01:15:46.879417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025214B17530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002520EB0BE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025213CB5E20>]}
[0m01:15:46.880414 [debug] [MainThread]: Flushing usage events
[0m01:16:09.375310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8A973530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8A972090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8A970EF0>]}


============================== 01:16:09.380331 | c3837665-640b-4847-9857-3d8a4ca38268 ==============================
[0m01:16:09.380331 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:16:09.381296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:16:09.886169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3837665-640b-4847-9857-3d8a4ca38268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8B255AC0>]}
[0m01:16:10.041875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3837665-640b-4847-9857-3d8a4ca38268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8B312FC0>]}
[0m01:16:10.047859 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:16:10.060633 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:16:10.277488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:16:10.277488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:16:10.342063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3837665-640b-4847-9857-3d8a4ca38268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8B579CD0>]}
[0m01:16:10.491316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3837665-640b-4847-9857-3d8a4ca38268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8C7258B0>]}
[0m01:16:10.491316 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m01:16:10.492660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3837665-640b-4847-9857-3d8a4ca38268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8B38D9D0>]}
[0m01:16:10.496579 [info ] [MainThread]: 
[0m01:16:10.496579 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:16:10.506457 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health'
[0m01:16:10.637960 [debug] [ThreadPool]: Using duckdb connection "list_mental_health"
[0m01:16:10.638959 [debug] [ThreadPool]: On list_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"mental_health"'
    
  
  
[0m01:16:10.638959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:10.752537 [debug] [ThreadPool]: SQL status: OK in 0.113 seconds
[0m01:16:10.760480 [debug] [ThreadPool]: On list_mental_health: Close
[0m01:16:10.762157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mental_health, now create_mental_health_main)
[0m01:16:10.769391 [debug] [ThreadPool]: Creating schema "database: "mental_health"
schema: "main"
"
[0m01:16:10.780350 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m01:16:10.781347 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='mental_health'
        and type='sqlite'
    
  
[0m01:16:10.781347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:16:10.782344 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:16:10.784339 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m01:16:10.784339 [debug] [ThreadPool]: On create_mental_health_main: BEGIN
[0m01:16:10.785336 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:16:10.785336 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m01:16:10.786334 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
    
        create schema if not exists "mental_health"."main"
    
[0m01:16:10.786334 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:16:10.787331 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m01:16:10.788328 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m01:16:10.788328 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m01:16:10.789325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:16:10.789325 [debug] [ThreadPool]: On create_mental_health_main: Close
[0m01:16:10.792183 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m01:16:10.801189 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m01:16:10.801189 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m01:16:10.802185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:10.802185 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:16:10.803183 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m01:16:10.803183 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m01:16:10.910017 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m01:16:10.912015 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m01:16:10.924730 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m01:16:10.924730 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m01:16:10.926537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3837665-640b-4847-9857-3d8a4ca38268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8C7328A0>]}
[0m01:16:10.926537 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:10.927572 [debug] [MainThread]: On master: BEGIN
[0m01:16:10.927572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:16:10.928567 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:16:10.928567 [debug] [MainThread]: On master: COMMIT
[0m01:16:10.928567 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:10.929692 [debug] [MainThread]: On master: COMMIT
[0m01:16:10.929692 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:16:10.930662 [debug] [MainThread]: On master: Close
[0m01:16:10.930662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:16:10.932245 [info ] [MainThread]: 
[0m01:16:10.935974 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.stg_mental_health
[0m01:16:10.937093 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_mental_health ............................. [RUN]
[0m01:16:10.938154 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.mental_health_analytics.stg_mental_health'
[0m01:16:10.938681 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.stg_mental_health
[0m01:16:10.948983 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.stg_mental_health"
[0m01:16:10.950981 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.stg_mental_health
[0m01:16:11.005806 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.stg_mental_health"
[0m01:16:11.007803 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m01:16:11.007803 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: BEGIN
[0m01:16:11.008831 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:16:11.009830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:11.009830 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m01:16:11.010823 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */

  
  create view "mental_health"."main"."stg_mental_health__dbt_tmp" as (
    

SELECT
    Timestamp,
    Gender,
    Country,
    Occupation,
    self_employed,
    CASE
        WHEN lower(family_history) = 'yes' THEN TRUE
        WHEN lower(family_history) = 'no' THEN FALSE
        ELSE NULL
    END as family_history,
    CASE
        WHEN lower(treatment) = 'yes' THEN TRUE
        WHEN lower(treatment) = 'no' THEN FALSE
        ELSE NULL
    END as treatment,
    Days_Indoors,
    CASE
        WHEN lower(Growing_Stress) = 'yes' THEN TRUE
        WHEN lower(Growing_Stress) = 'no' THEN FALSE
        ELSE NULL
    END as Growing_Stress,
    CASE
        WHEN lower(Changes_Habits) = 'yes' THEN TRUE
        WHEN lower(Changes_Habits) = 'no' THEN FALSE
        ELSE NULL
    END as Changes_Habits,
    CASE
        WHEN lower(Mental_Health_History) = 'yes' THEN TRUE
        WHEN lower(Mental_Health_History) = 'no' THEN FALSE
        ELSE NULL
    END as Mental_Health_History,
    Mood_Swings,
    CASE
        WHEN lower(Coping_Struggles) = 'yes' THEN TRUE
        WHEN lower(Coping_Struggles) = 'no' THEN FALSE
        ELSE NULL
    END as Coping_Struggles,
    CASE
        WHEN lower(Work_Interest) = 'yes' THEN TRUE
        WHEN lower(Work_Interest) = 'no' THEN FALSE
        ELSE NULL
    END as Work_Interest,
    CASE
        WHEN lower(Social_Weakness) = 'yes' THEN TRUE
        WHEN lower(Social_Weakness) = 'no' THEN FALSE
        ELSE NULL
    END as Social_Weakness,
    mental_health_interview,
    care_options
FROM raw_mental_health
  );

[0m01:16:11.012820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:11.022296 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m01:16:11.022296 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
alter view "mental_health"."main"."stg_mental_health__dbt_tmp" rename to "stg_mental_health"
[0m01:16:11.030198 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:16:11.054343 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: COMMIT
[0m01:16:11.054343 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m01:16:11.055340 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: COMMIT
[0m01:16:11.110376 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m01:16:11.119007 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m01:16:11.119007 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
drop view if exists "mental_health"."main"."stg_mental_health__dbt_backup" cascade
[0m01:16:11.120003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:16:11.123220 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: Close
[0m01:16:11.125644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3837665-640b-4847-9857-3d8a4ca38268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8A972930>]}
[0m01:16:11.126646 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_mental_health ........................ [[32mOK[0m in 0.19s]
[0m01:16:11.127243 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.stg_mental_health
[0m01:16:11.128696 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.dim_geography
[0m01:16:11.128696 [info ] [Thread-1 (]: 2 of 3 START sql table model main.dim_geography ................................ [RUN]
[0m01:16:11.129729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mental_health_analytics.stg_mental_health, now model.mental_health_analytics.dim_geography)
[0m01:16:11.130727 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.dim_geography
[0m01:16:11.135304 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.dim_geography"
[0m01:16:11.136301 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.dim_geography
[0m01:16:11.165874 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.dim_geography"
[0m01:16:11.167869 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m01:16:11.167869 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: BEGIN
[0m01:16:11.168866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:11.168866 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:11.169863 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m01:16:11.169863 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */

  
    
    

    create  table
      "mental_health"."main"."dim_geography__dbt_tmp"
  
    as (
      

SELECT
    ROW_NUMBER() OVER () as geography_id,
    Country,
    COUNT(*) as records_count
FROM "mental_health"."main"."stg_mental_health"
GROUP BY Country
    );
  
  
[0m01:16:11.222844 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m01:16:11.226838 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m01:16:11.227835 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
alter table "mental_health"."main"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m01:16:11.228832 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:16:11.236546 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: COMMIT
[0m01:16:11.237542 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m01:16:11.237542 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: COMMIT
[0m01:16:11.270704 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m01:16:11.274241 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m01:16:11.275239 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
drop table if exists "mental_health"."main"."dim_geography__dbt_backup" cascade
[0m01:16:11.275239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:16:11.277235 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: Close
[0m01:16:11.278231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3837665-640b-4847-9857-3d8a4ca38268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8CD3C500>]}
[0m01:16:11.278231 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.dim_geography ........................... [[32mOK[0m in 0.15s]
[0m01:16:11.279228 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.dim_geography
[0m01:16:11.280599 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.fact_mental_health
[0m01:16:11.281602 [info ] [Thread-1 (]: 3 of 3 START sql table model main.fact_mental_health ........................... [RUN]
[0m01:16:11.282224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mental_health_analytics.dim_geography, now model.mental_health_analytics.fact_mental_health)
[0m01:16:11.282224 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.fact_mental_health
[0m01:16:11.287215 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.fact_mental_health"
[0m01:16:11.289209 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.fact_mental_health
[0m01:16:11.293197 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.fact_mental_health"
[0m01:16:11.294195 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m01:16:11.295198 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: BEGIN
[0m01:16:11.296190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:11.296190 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:11.297187 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m01:16:11.297187 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */

  
    
    

    create  table
      "mental_health"."main"."fact_mental_health__dbt_tmp"
  
    as (
      

WITH geography AS (
    SELECT * FROM "mental_health"."main"."dim_geography"
)

SELECT
    m.Timestamp,
    EXTRACT(YEAR FROM m.Timestamp) as year,
    EXTRACT(MONTH FROM m.Timestamp) as month,
    m.Gender,
    g.geography_id,
    m.Occupation,
    m.self_employed,
    m.family_history,
    m.treatment,
    m.Days_Indoors,
    m.Growing_Stress,
    m.Changes_Habits,
    m.Mental_Health_History,
    m.Mood_Swings,
    m.Coping_Struggles,
    m.Work_Interest,
    m.Social_Weakness,
    CASE
        WHEN lower(m.mental_health_interview) = 'yes' THEN TRUE
        WHEN lower(m.mental_health_interview) = 'no' THEN FALSE
        WHEN lower(m.mental_health_interview) = 'maybe' THEN NULL
        ELSE NULL
    END as mental_health_interview,
    CASE
        WHEN lower(m.care_options) = 'yes' THEN TRUE
        WHEN lower(m.care_options) = 'no' THEN FALSE
        WHEN lower(m.care_options) = 'not sure' THEN NULL
        ELSE NULL
    END as care_options
FROM "mental_health"."main"."stg_mental_health" m
JOIN geography g ON m.Country = g.Country
    );
  
  
[0m01:16:11.343814 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m01:16:11.347806 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m01:16:11.347806 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
alter table "mental_health"."main"."fact_mental_health__dbt_tmp" rename to "fact_mental_health"
[0m01:16:11.348806 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:16:11.352796 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: COMMIT
[0m01:16:11.353793 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m01:16:11.353793 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: COMMIT
[0m01:16:11.386382 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m01:16:11.389380 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m01:16:11.390377 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
drop table if exists "mental_health"."main"."fact_mental_health__dbt_backup" cascade
[0m01:16:11.391375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:16:11.392372 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: Close
[0m01:16:11.393369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3837665-640b-4847-9857-3d8a4ca38268', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8CD92510>]}
[0m01:16:11.394366 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.fact_mental_health ...................... [[32mOK[0m in 0.11s]
[0m01:16:11.394907 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.fact_mental_health
[0m01:16:11.396908 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:11.396908 [debug] [MainThread]: On master: BEGIN
[0m01:16:11.397905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:16:11.397905 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:16:11.398902 [debug] [MainThread]: On master: COMMIT
[0m01:16:11.398902 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:11.399899 [debug] [MainThread]: On master: COMMIT
[0m01:16:11.399899 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:16:11.400897 [debug] [MainThread]: On master: Close
[0m01:16:11.400897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:11.400897 [debug] [MainThread]: Connection 'create_mental_health_main' was properly closed.
[0m01:16:11.401894 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m01:16:11.401894 [debug] [MainThread]: Connection 'model.mental_health_analytics.fact_mental_health' was properly closed.
[0m01:16:11.402891 [info ] [MainThread]: 
[0m01:16:11.403328 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m01:16:11.404942 [debug] [MainThread]: Command end result
[0m01:16:11.443339 [info ] [MainThread]: 
[0m01:16:11.444335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:16:11.444335 [info ] [MainThread]: 
[0m01:16:11.446331 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:16:11.447874 [debug] [MainThread]: Command `dbt run` succeeded at 01:16:11.447874 after 2.26 seconds
[0m01:16:11.447874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8AD85730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8A906810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8A907BF0>]}
[0m01:16:11.448872 [debug] [MainThread]: Flushing usage events
[0m01:16:32.298614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02D5E9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02D5EBDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02D5EBD70>]}


============================== 01:16:32.302608 | 7ebeb62f-3ef4-40fb-9bf4-74f7fbe504fa ==============================
[0m01:16:32.302608 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:16:32.303838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m01:16:32.806649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ebeb62f-3ef4-40fb-9bf4-74f7fbe504fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02D7B8B00>]}
[0m01:16:32.963406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ebeb62f-3ef4-40fb-9bf4-74f7fbe504fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02D87E270>]}
[0m01:16:32.969423 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m01:16:32.982690 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:16:33.209918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:16:33.209918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:16:33.273930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ebeb62f-3ef4-40fb-9bf4-74f7fbe504fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02DA8AD50>]}
[0m01:16:33.458754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ebeb62f-3ef4-40fb-9bf4-74f7fbe504fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02EE549E0>]}
[0m01:16:33.459803 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m01:16:33.460241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ebeb62f-3ef4-40fb-9bf4-74f7fbe504fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02DB36F00>]}
[0m01:16:33.464362 [info ] [MainThread]: 
[0m01:16:33.465879 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:16:33.473844 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m01:16:33.602969 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m01:16:33.603965 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m01:16:33.603965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:33.643718 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m01:16:33.643718 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m01:16:33.644716 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m01:16:33.674335 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m01:16:33.676331 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m01:16:33.679785 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m01:16:33.679785 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m01:16:33.681816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ebeb62f-3ef4-40fb-9bf4-74f7fbe504fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02EE1B650>]}
[0m01:16:33.682896 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:33.683434 [debug] [MainThread]: On master: BEGIN
[0m01:16:33.683434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:16:33.684474 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:16:33.684474 [debug] [MainThread]: On master: COMMIT
[0m01:16:33.685470 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:33.685470 [debug] [MainThread]: On master: COMMIT
[0m01:16:33.685470 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:16:33.685470 [debug] [MainThread]: On master: Close
[0m01:16:33.687010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:16:33.688018 [info ] [MainThread]: 
[0m01:16:33.691589 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m01:16:33.691589 [info ] [Thread-1 (]: 1 of 6 START test not_null_dim_geography_Country ............................... [RUN]
[0m01:16:33.692861 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535'
[0m01:16:33.692861 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m01:16:33.723490 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m01:16:33.724487 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m01:16:33.747342 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m01:16:33.748339 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m01:16:33.749337 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: BEGIN
[0m01:16:33.749337 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:16:33.750334 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:33.750334 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m01:16:33.751331 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Country
from "mental_health"."main"."dim_geography"
where Country is null



      
    ) dbt_internal_test
[0m01:16:33.779892 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m01:16:33.785630 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: ROLLBACK
[0m01:16:33.788148 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535'
[0m01:16:33.788148 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: Close
[0m01:16:33.789150 [info ] [Thread-1 (]: 1 of 6 PASS not_null_dim_geography_Country ..................................... [[32mPASS[0m in 0.10s]
[0m01:16:33.790072 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m01:16:33.791076 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m01:16:33.791076 [info ] [Thread-1 (]: 2 of 6 START test not_null_dim_geography_geography_id .......................... [RUN]
[0m01:16:33.792073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535, now test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0)
[0m01:16:33.793103 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m01:16:33.798527 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m01:16:33.800526 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m01:16:33.803516 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m01:16:33.804514 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m01:16:33.804514 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: BEGIN
[0m01:16:33.805512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:33.806509 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:33.806509 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m01:16:33.807506 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."dim_geography"
where geography_id is null



      
    ) dbt_internal_test
[0m01:16:33.809502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:33.811528 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: ROLLBACK
[0m01:16:33.812530 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0'
[0m01:16:33.813490 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: Close
[0m01:16:33.814489 [info ] [Thread-1 (]: 2 of 6 PASS not_null_dim_geography_geography_id ................................ [[32mPASS[0m in 0.02s]
[0m01:16:33.815860 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m01:16:33.816864 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m01:16:33.817867 [info ] [Thread-1 (]: 3 of 6 START test not_null_fact_mental_health_Timestamp ........................ [RUN]
[0m01:16:33.817867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0, now test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f)
[0m01:16:33.818872 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m01:16:33.826841 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m01:16:33.828574 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m01:16:33.832093 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m01:16:33.835101 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m01:16:33.835101 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: BEGIN
[0m01:16:33.836095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:33.836095 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:33.837093 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m01:16:33.837093 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Timestamp
from "mental_health"."main"."fact_mental_health"
where Timestamp is null



      
    ) dbt_internal_test
[0m01:16:33.840360 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:33.842353 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: ROLLBACK
[0m01:16:33.844009 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f'
[0m01:16:33.844515 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: Close
[0m01:16:33.845516 [info ] [Thread-1 (]: 3 of 6 PASS not_null_fact_mental_health_Timestamp .............................. [[32mPASS[0m in 0.03s]
[0m01:16:33.845978 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m01:16:33.847014 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m01:16:33.847014 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_mental_health_geography_id ..................... [RUN]
[0m01:16:33.849605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f, now test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474)
[0m01:16:33.849605 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m01:16:33.855627 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m01:16:33.857587 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m01:16:33.860578 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m01:16:33.861575 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m01:16:33.862574 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: BEGIN
[0m01:16:33.862574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:33.863570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:33.864569 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m01:16:33.865580 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."fact_mental_health"
where geography_id is null



      
    ) dbt_internal_test
[0m01:16:33.865580 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:33.869195 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: ROLLBACK
[0m01:16:33.871673 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474'
[0m01:16:33.872201 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: Close
[0m01:16:33.873284 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_mental_health_geography_id ........................... [[32mPASS[0m in 0.02s]
[0m01:16:33.874292 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m01:16:33.875297 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m01:16:33.876295 [info ] [Thread-1 (]: 5 of 6 START test relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_  [RUN]
[0m01:16:33.877250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474, now test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30)
[0m01:16:33.878253 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m01:16:33.893271 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m01:16:33.895270 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m01:16:33.898270 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m01:16:33.899769 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m01:16:33.901458 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: BEGIN
[0m01:16:33.902497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:33.903466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:33.903466 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m01:16:33.904463 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select geography_id as from_field
    from "mental_health"."main"."fact_mental_health"
    where geography_id is not null
),

parent as (
    select geography_id as to_field
    from "mental_health"."main"."dim_geography"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:16:33.907542 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:16:33.909539 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: ROLLBACK
[0m01:16:33.911772 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30'
[0m01:16:33.911772 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: Close
[0m01:16:33.912774 [info ] [Thread-1 (]: 5 of 6 PASS relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_  [[32mPASS[0m in 0.04s]
[0m01:16:33.914713 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m01:16:33.915701 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m01:16:33.916696 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_geography_geography_id ............................ [RUN]
[0m01:16:33.917697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30, now test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10)
[0m01:16:33.918696 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m01:16:33.931028 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m01:16:33.933605 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m01:16:33.936596 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m01:16:33.937593 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m01:16:33.938592 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: BEGIN
[0m01:16:33.938592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:33.939588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:16:33.940585 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m01:16:33.940585 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    geography_id as unique_field,
    count(*) as n_records

from "mental_health"."main"."dim_geography"
where geography_id is not null
group by geography_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:16:33.948620 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:16:33.950600 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: ROLLBACK
[0m01:16:33.952778 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10'
[0m01:16:33.952778 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: Close
[0m01:16:33.953780 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_geography_geography_id .................................. [[32mPASS[0m in 0.04s]
[0m01:16:33.954712 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m01:16:33.957981 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:33.957981 [debug] [MainThread]: On master: BEGIN
[0m01:16:33.957981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:16:33.958985 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:16:33.958985 [debug] [MainThread]: On master: COMMIT
[0m01:16:33.959982 [debug] [MainThread]: Using duckdb connection "master"
[0m01:16:33.959982 [debug] [MainThread]: On master: COMMIT
[0m01:16:33.960979 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:16:33.960979 [debug] [MainThread]: On master: Close
[0m01:16:33.961976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:33.961976 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m01:16:33.962974 [debug] [MainThread]: Connection 'test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10' was properly closed.
[0m01:16:33.962974 [info ] [MainThread]: 
[0m01:16:33.965981 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m01:16:33.968870 [debug] [MainThread]: Command end result
[0m01:16:34.012691 [info ] [MainThread]: 
[0m01:16:34.013689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:16:34.014686 [info ] [MainThread]: 
[0m01:16:34.015683 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m01:16:34.017346 [debug] [MainThread]: Command `dbt test` succeeded at 01:16:34.017346 after 1.90 seconds
[0m01:16:34.017346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02D5EBDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02D5E93D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D02D5EBC80>]}
[0m01:16:34.018350 [debug] [MainThread]: Flushing usage events
[0m13:45:48.218433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A438AAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A438A330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A4627FB0>]}


============================== 13:45:49.788183 | 40c130ea-8dcd-4405-9dbc-03ed077395c4 ==============================
[0m13:45:49.788183 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:45:49.789189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:45:56.818940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40c130ea-8dcd-4405-9dbc-03ed077395c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A4EDB6E0>]}
[0m13:45:57.548095 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:45:57.549956 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:45:57.563578 [debug] [MainThread]: Command `dbt deps` succeeded at 13:45:57.550448 after 9.75 seconds
[0m13:45:57.563578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A45925A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A4BE0A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A4AFE1E0>]}
[0m13:45:57.564581 [debug] [MainThread]: Flushing usage events
[0m13:46:06.046647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE8153BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE81514F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE8A39A30>]}


============================== 13:46:06.050668 | b5b4f96a-df4b-45b4-a564-c9a1baaae2f1 ==============================
[0m13:46:06.050668 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:46:06.051642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:46:10.123757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5b4f96a-df4b-45b4-a564-c9a1baaae2f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE8AF0B00>]}
[0m13:46:10.278490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5b4f96a-df4b-45b4-a564-c9a1baaae2f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE59DFB00>]}
[0m13:46:10.987348 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m13:46:11.004649 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m13:46:12.332843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:12.333844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:12.423090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5b4f96a-df4b-45b4-a564-c9a1baaae2f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE8CD6030>]}
[0m13:46:12.719903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5b4f96a-df4b-45b4-a564-c9a1baaae2f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE8E0E750>]}
[0m13:46:12.720901 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m13:46:12.721744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b4f96a-df4b-45b4-a564-c9a1baaae2f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE8AE7560>]}
[0m13:46:12.725737 [info ] [MainThread]: 
[0m13:46:12.726768 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:46:12.736142 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health'
[0m13:46:15.153706 [debug] [ThreadPool]: Using duckdb connection "list_mental_health"
[0m13:46:15.153706 [debug] [ThreadPool]: On list_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"mental_health"'
    
  
  
[0m13:46:15.154846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:15.333081 [debug] [ThreadPool]: SQL status: OK in 0.178 seconds
[0m13:46:15.334079 [debug] [ThreadPool]: On list_mental_health: Close
[0m13:46:15.335076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mental_health, now create_mental_health_main)
[0m13:46:15.336073 [debug] [ThreadPool]: Creating schema "database: "mental_health"
schema: "main"
"
[0m13:46:15.346952 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m13:46:15.347950 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='mental_health'
        and type='sqlite'
    
  
[0m13:46:15.347950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:15.348951 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:46:15.350941 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m13:46:15.350941 [debug] [ThreadPool]: On create_mental_health_main: BEGIN
[0m13:46:15.351940 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:46:15.352938 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m13:46:15.352938 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
    
        create schema if not exists "mental_health"."main"
    
[0m13:46:15.353956 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:46:15.354928 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m13:46:15.354928 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m13:46:15.354928 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m13:46:15.356469 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:46:15.356469 [debug] [ThreadPool]: On create_mental_health_main: Close
[0m13:46:15.358817 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m13:46:15.368219 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m13:46:15.368756 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m13:46:15.368756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:15.369790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:46:15.369790 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m13:46:15.370755 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m13:46:15.400758 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m13:46:15.402671 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m13:46:15.406802 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m13:46:15.407766 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m13:46:15.409829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b4f96a-df4b-45b4-a564-c9a1baaae2f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE8C46510>]}
[0m13:46:15.409829 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:15.410866 [debug] [MainThread]: On master: BEGIN
[0m13:46:15.410866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:15.411861 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:46:15.411861 [debug] [MainThread]: On master: COMMIT
[0m13:46:15.412860 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:15.412860 [debug] [MainThread]: On master: COMMIT
[0m13:46:15.413855 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:46:15.413855 [debug] [MainThread]: On master: Close
[0m13:46:15.414852 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:15.414852 [info ] [MainThread]: 
[0m13:46:15.481784 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.stg_mental_health
[0m13:46:15.481784 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_mental_health ............................. [RUN]
[0m13:46:15.482814 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.mental_health_analytics.stg_mental_health'
[0m13:46:15.483780 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.stg_mental_health
[0m13:46:15.494750 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.stg_mental_health"
[0m13:46:15.496745 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.stg_mental_health
[0m13:46:15.554365 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.stg_mental_health"
[0m13:46:15.555360 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m13:46:15.555360 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: BEGIN
[0m13:46:15.557088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:46:15.557598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:15.558605 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m13:46:15.558605 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */

  
  create view "mental_health"."main"."stg_mental_health__dbt_tmp" as (
    

SELECT
    Timestamp,
    Gender,
    Country,
    Occupation,
    self_employed,
    CASE
        WHEN lower(family_history) = 'yes' THEN TRUE
        WHEN lower(family_history) = 'no' THEN FALSE
        ELSE NULL
    END as family_history,
    CASE
        WHEN lower(treatment) = 'yes' THEN TRUE
        WHEN lower(treatment) = 'no' THEN FALSE
        ELSE NULL
    END as treatment,
    Days_Indoors,
    CASE
        WHEN lower(Growing_Stress) = 'yes' THEN TRUE
        WHEN lower(Growing_Stress) = 'no' THEN FALSE
        ELSE NULL
    END as Growing_Stress,
    CASE
        WHEN lower(Changes_Habits) = 'yes' THEN TRUE
        WHEN lower(Changes_Habits) = 'no' THEN FALSE
        ELSE NULL
    END as Changes_Habits,
    CASE
        WHEN lower(Mental_Health_History) = 'yes' THEN TRUE
        WHEN lower(Mental_Health_History) = 'no' THEN FALSE
        ELSE NULL
    END as Mental_Health_History,
    Mood_Swings,
    CASE
        WHEN lower(Coping_Struggles) = 'yes' THEN TRUE
        WHEN lower(Coping_Struggles) = 'no' THEN FALSE
        ELSE NULL
    END as Coping_Struggles,
    CASE
        WHEN lower(Work_Interest) = 'yes' THEN TRUE
        WHEN lower(Work_Interest) = 'no' THEN FALSE
        ELSE NULL
    END as Work_Interest,
    CASE
        WHEN lower(Social_Weakness) = 'yes' THEN TRUE
        WHEN lower(Social_Weakness) = 'no' THEN FALSE
        ELSE NULL
    END as Social_Weakness,
    mental_health_interview,
    care_options
FROM raw_mental_health
  );

[0m13:46:15.560600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:15.571124 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m13:46:15.571648 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
alter view "mental_health"."main"."stg_mental_health" rename to "stg_mental_health__dbt_backup"
[0m13:46:15.572651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:46:15.576638 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m13:46:15.576638 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
alter view "mental_health"."main"."stg_mental_health__dbt_tmp" rename to "stg_mental_health"
[0m13:46:15.577635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:46:15.599458 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: COMMIT
[0m13:46:15.599458 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m13:46:15.600455 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: COMMIT
[0m13:46:15.643068 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m13:46:15.652085 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m13:46:15.652085 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
drop view if exists "mental_health"."main"."stg_mental_health__dbt_backup" cascade
[0m13:46:15.714559 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m13:46:15.717933 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: Close
[0m13:46:15.719932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b4f96a-df4b-45b4-a564-c9a1baaae2f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE626F7D0>]}
[0m13:46:15.721475 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_mental_health ........................ [[32mOK[0m in 0.24s]
[0m13:46:15.722478 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.stg_mental_health
[0m13:46:15.723244 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.dim_geography
[0m13:46:15.724245 [info ] [Thread-1 (]: 2 of 3 START sql table model main.dim_geography ................................ [RUN]
[0m13:46:15.724777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mental_health_analytics.stg_mental_health, now model.mental_health_analytics.dim_geography)
[0m13:46:15.724777 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.dim_geography
[0m13:46:15.729235 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.dim_geography"
[0m13:46:15.730237 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.dim_geography
[0m13:46:15.760326 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.dim_geography"
[0m13:46:15.774493 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m13:46:15.774493 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: BEGIN
[0m13:46:15.774493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:15.776050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:15.777123 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m13:46:15.777645 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */

  
    
    

    create  table
      "mental_health"."main"."dim_geography__dbt_tmp"
  
    as (
      

SELECT
    ROW_NUMBER() OVER () as geography_id,
    Country,
    COUNT(*) as records_count
FROM "mental_health"."main"."stg_mental_health"
GROUP BY Country
    );
  
  
[0m13:46:15.781724 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:46:15.784750 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m13:46:15.785745 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
alter table "mental_health"."main"."dim_geography" rename to "dim_geography__dbt_backup"
[0m13:46:15.786744 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:46:15.790734 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m13:46:15.791730 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
alter table "mental_health"."main"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m13:46:15.791730 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:46:15.800389 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: COMMIT
[0m13:46:15.800389 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m13:46:15.801386 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: COMMIT
[0m13:46:15.831075 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m13:46:15.834073 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m13:46:15.835070 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
drop table if exists "mental_health"."main"."dim_geography__dbt_backup" cascade
[0m13:46:15.869599 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m13:46:15.871633 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: Close
[0m13:46:15.872627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b4f96a-df4b-45b4-a564-c9a1baaae2f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEA490FE0>]}
[0m13:46:15.873626 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.dim_geography ........................... [[32mOK[0m in 0.15s]
[0m13:46:15.874591 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.dim_geography
[0m13:46:15.875407 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.fact_mental_health
[0m13:46:15.876410 [info ] [Thread-1 (]: 3 of 3 START sql table model main.fact_mental_health ........................... [RUN]
[0m13:46:15.876410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mental_health_analytics.dim_geography, now model.mental_health_analytics.fact_mental_health)
[0m13:46:15.877407 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.fact_mental_health
[0m13:46:15.882660 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.fact_mental_health"
[0m13:46:15.894487 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.fact_mental_health
[0m13:46:15.901504 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.fact_mental_health"
[0m13:46:15.916558 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m13:46:15.917850 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: BEGIN
[0m13:46:15.918854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:15.918854 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:15.919850 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m13:46:15.920848 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */

  
    
    

    create  table
      "mental_health"."main"."fact_mental_health__dbt_tmp"
  
    as (
      

WITH geography AS (
    SELECT * FROM "mental_health"."main"."dim_geography"
)

SELECT
    m.Timestamp,
    EXTRACT(YEAR FROM m.Timestamp) as year,
    EXTRACT(MONTH FROM m.Timestamp) as month,
    m.Gender,
    g.geography_id,
    m.Occupation,
    m.self_employed,
    m.family_history,
    m.treatment,
    m.Days_Indoors,
    m.Growing_Stress,
    m.Changes_Habits,
    m.Mental_Health_History,
    m.Mood_Swings,
    m.Coping_Struggles,
    m.Work_Interest,
    m.Social_Weakness,
    CASE
        WHEN lower(m.mental_health_interview) = 'yes' THEN TRUE
        WHEN lower(m.mental_health_interview) = 'no' THEN FALSE
        WHEN lower(m.mental_health_interview) = 'maybe' THEN NULL
        ELSE NULL
    END as mental_health_interview,
    CASE
        WHEN lower(m.care_options) = 'yes' THEN TRUE
        WHEN lower(m.care_options) = 'no' THEN FALSE
        WHEN lower(m.care_options) = 'not sure' THEN NULL
        ELSE NULL
    END as care_options
FROM "mental_health"."main"."stg_mental_health" m
JOIN geography g ON m.Country = g.Country
    );
  
  
[0m13:46:15.926341 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:46:15.930330 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m13:46:15.931364 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
alter table "mental_health"."main"."fact_mental_health" rename to "fact_mental_health__dbt_backup"
[0m13:46:15.932355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:46:15.936345 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m13:46:15.936345 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
alter table "mental_health"."main"."fact_mental_health__dbt_tmp" rename to "fact_mental_health"
[0m13:46:15.937345 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:46:15.939339 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: COMMIT
[0m13:46:15.940336 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m13:46:15.940336 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: COMMIT
[0m13:46:15.975144 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m13:46:15.979829 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m13:46:15.979829 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
drop table if exists "mental_health"."main"."fact_mental_health__dbt_backup" cascade
[0m13:46:16.013845 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m13:46:16.015847 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: Close
[0m13:46:16.016843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b4f96a-df4b-45b4-a564-c9a1baaae2f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEA5670E0>]}
[0m13:46:16.016843 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.fact_mental_health ...................... [[32mOK[0m in 0.14s]
[0m13:46:16.018031 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.fact_mental_health
[0m13:46:16.019324 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:16.020355 [debug] [MainThread]: On master: BEGIN
[0m13:46:16.020355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:16.020355 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:46:16.021898 [debug] [MainThread]: On master: COMMIT
[0m13:46:16.021898 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:16.021898 [debug] [MainThread]: On master: COMMIT
[0m13:46:16.022931 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:46:16.023929 [debug] [MainThread]: On master: Close
[0m13:46:16.023929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:16.024927 [debug] [MainThread]: Connection 'create_mental_health_main' was properly closed.
[0m13:46:16.024927 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m13:46:16.024927 [debug] [MainThread]: Connection 'model.mental_health_analytics.fact_mental_health' was properly closed.
[0m13:46:16.025923 [info ] [MainThread]: 
[0m13:46:16.026701 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m13:46:16.027702 [debug] [MainThread]: Command end result
[0m13:46:16.066106 [info ] [MainThread]: 
[0m13:46:16.067103 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:16.067103 [info ] [MainThread]: 
[0m13:46:16.068100 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:46:16.070095 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:16.069097 after 10.20 seconds
[0m13:46:16.071095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE86106B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE8A62510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DE87521E0>]}
[0m13:46:16.071095 [debug] [MainThread]: Flushing usage events
[0m13:46:24.964902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE5A78F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE80383E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE8038AD0>]}


============================== 13:46:24.969892 | e22b95c5-9ace-412b-a5a3-276d36a6df69 ==============================
[0m13:46:24.969892 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:46:24.970336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:46:25.473655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e22b95c5-9ace-412b-a5a3-276d36a6df69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE8603B90>]}
[0m13:46:25.629361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e22b95c5-9ace-412b-a5a3-276d36a6df69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE72BE390>]}
[0m13:46:25.635828 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m13:46:25.647693 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m13:46:25.863992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:25.864990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:25.928554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e22b95c5-9ace-412b-a5a3-276d36a6df69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE88B2A80>]}
[0m13:46:26.988175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e22b95c5-9ace-412b-a5a3-276d36a6df69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE9C7CB30>]}
[0m13:46:26.989178 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m13:46:26.990097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e22b95c5-9ace-412b-a5a3-276d36a6df69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE9AC2E70>]}
[0m13:46:26.993790 [info ] [MainThread]: 
[0m13:46:26.994844 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:46:27.003356 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m13:46:27.134092 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m13:46:27.134092 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m13:46:27.134092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:27.153041 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:46:27.154041 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m13:46:27.154041 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m13:46:27.183582 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m13:46:27.185577 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m13:46:27.189566 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m13:46:27.189566 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m13:46:27.192353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e22b95c5-9ace-412b-a5a3-276d36a6df69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE882A990>]}
[0m13:46:27.192353 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:27.193387 [debug] [MainThread]: On master: BEGIN
[0m13:46:27.193387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:27.194389 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:46:27.194389 [debug] [MainThread]: On master: COMMIT
[0m13:46:27.195382 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:27.195382 [debug] [MainThread]: On master: COMMIT
[0m13:46:27.196346 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:46:27.196346 [debug] [MainThread]: On master: Close
[0m13:46:27.196346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:27.197376 [info ] [MainThread]: 
[0m13:46:27.201420 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m13:46:27.201420 [info ] [Thread-1 (]: 1 of 6 START test not_null_dim_geography_Country ............................... [RUN]
[0m13:46:27.202702 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535'
[0m13:46:27.202702 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m13:46:27.233305 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m13:46:27.345839 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m13:46:27.368568 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m13:46:27.380079 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m13:46:27.380079 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: BEGIN
[0m13:46:27.381072 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:46:27.381072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.382070 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m13:46:27.382070 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Country
from "mental_health"."main"."dim_geography"
where Country is null



      
    ) dbt_internal_test
[0m13:46:27.383571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.389558 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: ROLLBACK
[0m13:46:27.391552 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535'
[0m13:46:27.392584 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: Close
[0m13:46:27.393646 [info ] [Thread-1 (]: 1 of 6 PASS not_null_dim_geography_Country ..................................... [[32mPASS[0m in 0.19s]
[0m13:46:27.394151 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m13:46:27.395154 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m13:46:27.396151 [info ] [Thread-1 (]: 2 of 6 START test not_null_dim_geography_geography_id .......................... [RUN]
[0m13:46:27.396151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535, now test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0)
[0m13:46:27.397147 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m13:46:27.402986 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m13:46:27.405072 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m13:46:27.409064 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m13:46:27.411064 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m13:46:27.411064 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: BEGIN
[0m13:46:27.412093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:27.412093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.413087 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m13:46:27.413087 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."dim_geography"
where geography_id is null



      
    ) dbt_internal_test
[0m13:46:27.415050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.416084 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: ROLLBACK
[0m13:46:27.418079 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0'
[0m13:46:27.419043 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: Close
[0m13:46:27.420039 [info ] [Thread-1 (]: 2 of 6 PASS not_null_dim_geography_geography_id ................................ [[32mPASS[0m in 0.02s]
[0m13:46:27.420426 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m13:46:27.421466 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m13:46:27.422476 [info ] [Thread-1 (]: 3 of 6 START test not_null_fact_mental_health_Timestamp ........................ [RUN]
[0m13:46:27.424420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0, now test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f)
[0m13:46:27.426414 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m13:46:27.431991 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m13:46:27.433988 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m13:46:27.437200 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m13:46:27.439554 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m13:46:27.439554 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: BEGIN
[0m13:46:27.440584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:27.441568 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.442546 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m13:46:27.442546 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Timestamp
from "mental_health"."main"."fact_mental_health"
where Timestamp is null



      
    ) dbt_internal_test
[0m13:46:27.444540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.446535 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: ROLLBACK
[0m13:46:27.447533 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f'
[0m13:46:27.448564 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: Close
[0m13:46:27.449562 [info ] [Thread-1 (]: 3 of 6 PASS not_null_fact_mental_health_Timestamp .............................. [[32mPASS[0m in 0.03s]
[0m13:46:27.450524 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m13:46:27.451579 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m13:46:27.452893 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_mental_health_geography_id ..................... [RUN]
[0m13:46:27.453467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f, now test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474)
[0m13:46:27.454469 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m13:46:27.461721 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m13:46:27.463720 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m13:46:27.466710 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m13:46:27.467708 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m13:46:27.467708 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: BEGIN
[0m13:46:27.468706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:27.469703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.469703 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m13:46:27.471701 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."fact_mental_health"
where geography_id is null



      
    ) dbt_internal_test
[0m13:46:27.473727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.475687 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: ROLLBACK
[0m13:46:27.477681 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474'
[0m13:46:27.478713 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: Close
[0m13:46:27.478713 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_mental_health_geography_id ........................... [[32mPASS[0m in 0.03s]
[0m13:46:27.480677 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m13:46:27.481679 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m13:46:27.482671 [info ] [Thread-1 (]: 5 of 6 START test relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_  [RUN]
[0m13:46:27.483668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474, now test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30)
[0m13:46:27.483668 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m13:46:27.499881 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m13:46:27.500878 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m13:46:27.509856 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m13:46:27.511849 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m13:46:27.511849 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: BEGIN
[0m13:46:27.512850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:27.513846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.513846 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m13:46:27.514843 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select geography_id as from_field
    from "mental_health"."main"."fact_mental_health"
    where geography_id is not null
),

parent as (
    select geography_id as to_field
    from "mental_health"."main"."dim_geography"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:46:27.516842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.518835 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: ROLLBACK
[0m13:46:27.520667 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30'
[0m13:46:27.520667 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: Close
[0m13:46:27.521669 [info ] [Thread-1 (]: 5 of 6 PASS relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_  [[32mPASS[0m in 0.04s]
[0m13:46:27.522615 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m13:46:27.523649 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m13:46:27.524616 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_geography_geography_id ............................ [RUN]
[0m13:46:27.525638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30, now test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10)
[0m13:46:27.526642 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m13:46:27.539796 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m13:46:27.541374 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m13:46:27.546083 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m13:46:27.549113 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m13:46:27.551257 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: BEGIN
[0m13:46:27.551764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:27.552812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.553326 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m13:46:27.553841 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    geography_id as unique_field,
    count(*) as n_records

from "mental_health"."main"."dim_geography"
where geography_id is not null
group by geography_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:46:27.555439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:46:27.557500 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: ROLLBACK
[0m13:46:27.560940 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10'
[0m13:46:27.561483 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: Close
[0m13:46:27.562106 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_geography_geography_id .................................. [[32mPASS[0m in 0.04s]
[0m13:46:27.562643 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m13:46:27.564646 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:27.565677 [debug] [MainThread]: On master: BEGIN
[0m13:46:27.565677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:27.566676 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:46:27.566676 [debug] [MainThread]: On master: COMMIT
[0m13:46:27.567670 [debug] [MainThread]: Using duckdb connection "master"
[0m13:46:27.567670 [debug] [MainThread]: On master: COMMIT
[0m13:46:27.568640 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:46:27.568640 [debug] [MainThread]: On master: Close
[0m13:46:27.569669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:27.569669 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m13:46:27.569669 [debug] [MainThread]: Connection 'test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10' was properly closed.
[0m13:46:27.570662 [info ] [MainThread]: 
[0m13:46:27.570662 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m13:46:27.572955 [debug] [MainThread]: Command end result
[0m13:46:27.617824 [info ] [MainThread]: 
[0m13:46:27.618830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:27.619340 [info ] [MainThread]: 
[0m13:46:27.620125 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:46:27.622126 [debug] [MainThread]: Command `dbt test` succeeded at 13:46:27.622126 after 2.83 seconds
[0m13:46:27.622126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE81EF8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE81EDAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DE8272F30>]}
[0m13:46:27.623124 [debug] [MainThread]: Flushing usage events
[0m14:08:41.885054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726AEE8BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726AFC2B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726A5DE4E0>]}


============================== 14:08:41.915066 | 0d8cd1c9-02fc-44b6-b711-d8875d17cfd6 ==============================
[0m14:08:41.915066 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:08:41.916038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:43.616039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d8cd1c9-02fc-44b6-b711-d8875d17cfd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726AEEBB00>]}
[0m14:08:43.737206 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:08:43.740318 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:08:43.750149 [debug] [MainThread]: Command `dbt deps` succeeded at 14:08:43.741662 after 2.08 seconds
[0m14:08:43.750149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726A452840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172679FE3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726B598800>]}
[0m14:08:43.751153 [debug] [MainThread]: Flushing usage events
[0m14:09:03.324963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEEDACE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF1885910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF1886F90>]}


============================== 14:09:03.328955 | cfd8e19b-ff58-478c-918b-30c2a3ded5fc ==============================
[0m14:09:03.328955 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:09:03.330099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:04.137704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfd8e19b-ff58-478c-918b-30c2a3ded5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF1943410>]}
[0m14:09:04.290834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfd8e19b-ff58-478c-918b-30c2a3ded5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF0A7FFB0>]}
[0m14:09:04.332901 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:09:04.346268 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:09:04.750331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:04.751341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:04.814803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfd8e19b-ff58-478c-918b-30c2a3ded5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF1B6D460>]}
[0m14:09:04.988293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfd8e19b-ff58-478c-918b-30c2a3ded5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF1CAEA20>]}
[0m14:09:04.988293 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m14:09:04.989296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfd8e19b-ff58-478c-918b-30c2a3ded5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF151D4F0>]}
[0m14:09:04.993266 [info ] [MainThread]: 
[0m14:09:04.994165 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:09:05.003347 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health'
[0m14:09:05.209154 [debug] [ThreadPool]: Using duckdb connection "list_mental_health"
[0m14:09:05.210151 [debug] [ThreadPool]: On list_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"mental_health"'
    
  
  
[0m14:09:05.210151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:33.192783 [debug] [ThreadPool]: SQL status: OK in 27.982 seconds
[0m14:09:33.199033 [debug] [ThreadPool]: On list_mental_health: Close
[0m14:09:33.200024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mental_health, now create_mental_health_main)
[0m14:09:33.211032 [debug] [ThreadPool]: Creating schema "database: "mental_health"
schema: "main"
"
[0m14:09:33.221583 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m14:09:33.222161 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='mental_health'
        and type='sqlite'
    
  
[0m14:09:33.222161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:33.223740 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:09:33.241385 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m14:09:33.242380 [debug] [ThreadPool]: On create_mental_health_main: BEGIN
[0m14:09:33.242380 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:33.243377 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m14:09:33.243377 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
    
        
    
[0m14:09:33.243377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:33.244374 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m14:09:33.245372 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m14:09:33.245877 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m14:09:33.246923 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:09:33.247446 [debug] [ThreadPool]: On create_mental_health_main: Close
[0m14:09:33.249526 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m14:09:33.258508 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m14:09:33.258508 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m14:09:33.259505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:33.259505 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:09:33.260502 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m14:09:33.260502 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m14:09:33.319028 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m14:09:33.320025 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m14:09:33.333882 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m14:09:33.333882 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m14:09:33.335486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfd8e19b-ff58-478c-918b-30c2a3ded5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEF360770>]}
[0m14:09:33.335486 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:33.336521 [debug] [MainThread]: On master: BEGIN
[0m14:09:33.336521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:33.337517 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:09:33.337517 [debug] [MainThread]: On master: COMMIT
[0m14:09:33.338517 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:33.338517 [debug] [MainThread]: On master: COMMIT
[0m14:09:33.339511 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:33.339511 [debug] [MainThread]: On master: Close
[0m14:09:33.340511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:33.340511 [info ] [MainThread]: 
[0m14:09:33.344674 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.stg_mental_health
[0m14:09:33.345674 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_mental_health ............................. [RUN]
[0m14:09:33.345674 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.mental_health_analytics.stg_mental_health'
[0m14:09:33.346671 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.stg_mental_health
[0m14:09:33.360396 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.stg_mental_health"
[0m14:09:33.362503 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.stg_mental_health
[0m14:09:33.416909 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.stg_mental_health"
[0m14:09:33.418873 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m14:09:33.418873 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: BEGIN
[0m14:09:33.419903 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:09:33.420867 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:09:33.420867 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m14:09:33.421896 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */

  
  create view "mental_health"."main"."stg_mental_health__dbt_tmp" as (
    

SELECT
    Timestamp,
    Gender,
    Country,
    Occupation,
    self_employed,
    CASE
        WHEN lower(family_history) = 'yes' THEN TRUE
        WHEN lower(family_history) = 'no' THEN FALSE
        ELSE NULL
    END as family_history,
    CASE
        WHEN lower(treatment) = 'yes' THEN TRUE
        WHEN lower(treatment) = 'no' THEN FALSE
        ELSE NULL
    END as treatment,
    Days_Indoors,
    CASE
        WHEN lower(Growing_Stress) = 'yes' THEN TRUE
        WHEN lower(Growing_Stress) = 'no' THEN FALSE
        ELSE NULL
    END as Growing_Stress,
    CASE
        WHEN lower(Changes_Habits) = 'yes' THEN TRUE
        WHEN lower(Changes_Habits) = 'no' THEN FALSE
        ELSE NULL
    END as Changes_Habits,
    CASE
        WHEN lower(Mental_Health_History) = 'yes' THEN TRUE
        WHEN lower(Mental_Health_History) = 'no' THEN FALSE
        ELSE NULL
    END as Mental_Health_History,
    Mood_Swings,
    CASE
        WHEN lower(Coping_Struggles) = 'yes' THEN TRUE
        WHEN lower(Coping_Struggles) = 'no' THEN FALSE
        ELSE NULL
    END as Coping_Struggles,
    CASE
        WHEN lower(Work_Interest) = 'yes' THEN TRUE
        WHEN lower(Work_Interest) = 'no' THEN FALSE
        ELSE NULL
    END as Work_Interest,
    CASE
        WHEN lower(Social_Weakness) = 'yes' THEN TRUE
        WHEN lower(Social_Weakness) = 'no' THEN FALSE
        ELSE NULL
    END as Social_Weakness,
    mental_health_interview,
    care_options
FROM raw_mental_health
  );

[0m14:09:33.494746 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */

  
  create view "mental_health"."main"."stg_mental_health__dbt_tmp" as (
    

SELECT
    Timestamp,
    Gender,
    Country,
    Occupation,
    self_employed,
    CASE
        WHEN lower(family_history) = 'yes' THEN TRUE
        WHEN lower(family_history) = 'no' THEN FALSE
        ELSE NULL
    END as family_history,
    CASE
        WHEN lower(treatment) = 'yes' THEN TRUE
        WHEN lower(treatment) = 'no' THEN FALSE
        ELSE NULL
    END as treatment,
    Days_Indoors,
    CASE
        WHEN lower(Growing_Stress) = 'yes' THEN TRUE
        WHEN lower(Growing_Stress) = 'no' THEN FALSE
        ELSE NULL
    END as Growing_Stress,
    CASE
        WHEN lower(Changes_Habits) = 'yes' THEN TRUE
        WHEN lower(Changes_Habits) = 'no' THEN FALSE
        ELSE NULL
    END as Changes_Habits,
    CASE
        WHEN lower(Mental_Health_History) = 'yes' THEN TRUE
        WHEN lower(Mental_Health_History) = 'no' THEN FALSE
        ELSE NULL
    END as Mental_Health_History,
    Mood_Swings,
    CASE
        WHEN lower(Coping_Struggles) = 'yes' THEN TRUE
        WHEN lower(Coping_Struggles) = 'no' THEN FALSE
        ELSE NULL
    END as Coping_Struggles,
    CASE
        WHEN lower(Work_Interest) = 'yes' THEN TRUE
        WHEN lower(Work_Interest) = 'no' THEN FALSE
        ELSE NULL
    END as Work_Interest,
    CASE
        WHEN lower(Social_Weakness) = 'yes' THEN TRUE
        WHEN lower(Social_Weakness) = 'no' THEN FALSE
        ELSE NULL
    END as Social_Weakness,
    mental_health_interview,
    care_options
FROM raw_mental_health
  );

[0m14:09:33.495751 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:09:33.495751 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: ROLLBACK
[0m14:09:33.695720 [debug] [Thread-1 (]: Failed to rollback 'model.mental_health_analytics.stg_mental_health'
[0m14:09:33.696722 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: Close
[0m14:09:33.706433 [debug] [Thread-1 (]: Runtime Error in model stg_mental_health (models\staging\stg_mental_health.sql)
  Catalog Error: Table with name raw_mental_health does not exist!
  Did you mean "pragma_database_list"?
  
  LINE 57: FROM raw_mental_health
                ^
[0m14:09:33.709525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfd8e19b-ff58-478c-918b-30c2a3ded5fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF0FA2E10>]}
[0m14:09:33.710527 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_mental_health .................... [[31mERROR[0m in 0.36s]
[0m14:09:33.711138 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.stg_mental_health
[0m14:09:33.714576 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.dim_geography
[0m14:09:33.714576 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.dim_geography ........................................ [[33mSKIP[0m]
[0m14:09:33.715849 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.dim_geography
[0m14:09:33.716686 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.fact_mental_health
[0m14:09:33.717720 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.fact_mental_health ................................... [[33mSKIP[0m]
[0m14:09:33.717720 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.fact_mental_health
[0m14:09:33.719681 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:33.719681 [debug] [MainThread]: On master: BEGIN
[0m14:09:33.720678 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:33.721679 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:09:33.721679 [debug] [MainThread]: On master: COMMIT
[0m14:09:33.721679 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:33.722673 [debug] [MainThread]: On master: COMMIT
[0m14:09:33.722673 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:09:33.722673 [debug] [MainThread]: On master: Close
[0m14:09:33.724180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:33.724180 [debug] [MainThread]: Connection 'create_mental_health_main' was properly closed.
[0m14:09:33.725180 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m14:09:33.725180 [debug] [MainThread]: Connection 'model.mental_health_analytics.stg_mental_health' was properly closed.
[0m14:09:33.725180 [info ] [MainThread]: 
[0m14:09:33.726403 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 28.73 seconds (28.73s).
[0m14:09:33.727403 [debug] [MainThread]: Command end result
[0m14:09:33.765379 [info ] [MainThread]: 
[0m14:09:33.767504 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:09:33.768541 [info ] [MainThread]: 
[0m14:09:33.769068 [error] [MainThread]:   Runtime Error in model stg_mental_health (models\staging\stg_mental_health.sql)
  Catalog Error: Table with name raw_mental_health does not exist!
  Did you mean "pragma_database_list"?
  
  LINE 57: FROM raw_mental_health
                ^
[0m14:09:33.769827 [info ] [MainThread]: 
[0m14:09:33.770448 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m14:09:33.772076 [debug] [MainThread]: Command `dbt run` failed at 14:09:33.771075 after 30.62 seconds
[0m14:09:33.772076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF18AD280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2DBF410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF0870410>]}
[0m14:09:33.773073 [debug] [MainThread]: Flushing usage events
[0m14:11:03.284789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C147902360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C14799C560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C147C29010>]}


============================== 14:11:03.289813 | 1b38fa1b-c5c7-4c9c-8f28-782a0f5f7dd8 ==============================
[0m14:11:03.289813 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:11:03.290779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:03.605563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b38fa1b-c5c7-4c9c-8f28-782a0f5f7dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C147DDFD40>]}
[0m14:11:03.635327 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:11:03.637542 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:11:03.639036 [debug] [MainThread]: Command `dbt deps` succeeded at 14:11:03.638035 after 0.58 seconds
[0m14:11:03.639036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C147E6C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C147C4E2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C147DFB470>]}
[0m14:11:03.640032 [debug] [MainThread]: Flushing usage events
[0m14:11:18.555484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A0C16BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A27FE5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A27FC530>]}


============================== 14:11:18.559501 | 70a7a89a-2487-438c-9465-c50330924350 ==============================
[0m14:11:18.559501 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:11:18.560500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:19.068314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70a7a89a-2487-438c-9465-c50330924350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A3C83950>]}
[0m14:11:19.220200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70a7a89a-2487-438c-9465-c50330924350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A3AE3050>]}
[0m14:11:19.226184 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:11:19.239905 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:11:19.457340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:19.457340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:19.520856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70a7a89a-2487-438c-9465-c50330924350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A3D3E240>]}
[0m14:11:19.667755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70a7a89a-2487-438c-9465-c50330924350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A4F75040>]}
[0m14:11:19.668754 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m14:11:19.669289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a7a89a-2487-438c-9465-c50330924350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A3E0C740>]}
[0m14:11:19.673193 [info ] [MainThread]: 
[0m14:11:19.674131 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:11:19.683115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health'
[0m14:11:19.831207 [debug] [ThreadPool]: Using duckdb connection "list_mental_health"
[0m14:11:19.831207 [debug] [ThreadPool]: On list_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"mental_health"'
    
  
  
[0m14:11:19.832205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:19.964127 [debug] [ThreadPool]: SQL status: OK in 0.132 seconds
[0m14:11:19.966165 [debug] [ThreadPool]: On list_mental_health: Close
[0m14:11:19.967164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mental_health, now create_mental_health_main)
[0m14:11:19.968160 [debug] [ThreadPool]: Creating schema "database: "mental_health"
schema: "main"
"
[0m14:11:19.978708 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m14:11:19.979705 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='mental_health'
        and type='sqlite'
    
  
[0m14:11:19.979705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:19.980702 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:11:19.982697 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m14:11:19.982697 [debug] [ThreadPool]: On create_mental_health_main: BEGIN
[0m14:11:19.983694 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:11:19.983694 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m14:11:19.984691 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
    
        create schema if not exists "mental_health"."main"
    
[0m14:11:19.995708 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m14:11:19.996710 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m14:11:19.997706 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m14:11:19.997706 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m14:11:19.998703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:11:19.998703 [debug] [ThreadPool]: On create_mental_health_main: Close
[0m14:11:20.000870 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m14:11:20.009602 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m14:11:20.009602 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m14:11:20.010599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:20.011596 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:11:20.011596 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m14:11:20.011596 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m14:11:20.052733 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m14:11:20.054760 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m14:11:20.058314 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m14:11:20.058314 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m14:11:20.060706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a7a89a-2487-438c-9465-c50330924350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A15706E0>]}
[0m14:11:20.060706 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:20.061740 [debug] [MainThread]: On master: BEGIN
[0m14:11:20.061740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:20.062740 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:11:20.062740 [debug] [MainThread]: On master: COMMIT
[0m14:11:20.063734 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:20.063734 [debug] [MainThread]: On master: COMMIT
[0m14:11:20.064699 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:20.065204 [debug] [MainThread]: On master: Close
[0m14:11:20.066206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:20.067507 [info ] [MainThread]: 
[0m14:11:20.071176 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.stg_mental_health
[0m14:11:20.072177 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_mental_health ............................. [RUN]
[0m14:11:20.072617 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.mental_health_analytics.stg_mental_health'
[0m14:11:20.072617 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.stg_mental_health
[0m14:11:20.084572 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.stg_mental_health"
[0m14:11:20.085574 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.stg_mental_health
[0m14:11:20.141234 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.stg_mental_health"
[0m14:11:20.142231 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m14:11:20.143229 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: BEGIN
[0m14:11:20.143229 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:11:20.144226 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:20.145222 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m14:11:20.145222 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */

  
  create view "mental_health"."main"."stg_mental_health__dbt_tmp" as (
    

SELECT
    Timestamp,
    Gender,
    Country,
    Occupation,
    self_employed,
    CASE
        WHEN lower(family_history) = 'yes' THEN TRUE
        WHEN lower(family_history) = 'no' THEN FALSE
        ELSE NULL
    END as family_history,
    CASE
        WHEN lower(treatment) = 'yes' THEN TRUE
        WHEN lower(treatment) = 'no' THEN FALSE
        ELSE NULL
    END as treatment,
    Days_Indoors,
    CASE
        WHEN lower(Growing_Stress) = 'yes' THEN TRUE
        WHEN lower(Growing_Stress) = 'no' THEN FALSE
        ELSE NULL
    END as Growing_Stress,
    CASE
        WHEN lower(Changes_Habits) = 'yes' THEN TRUE
        WHEN lower(Changes_Habits) = 'no' THEN FALSE
        ELSE NULL
    END as Changes_Habits,
    CASE
        WHEN lower(Mental_Health_History) = 'yes' THEN TRUE
        WHEN lower(Mental_Health_History) = 'no' THEN FALSE
        ELSE NULL
    END as Mental_Health_History,
    Mood_Swings,
    CASE
        WHEN lower(Coping_Struggles) = 'yes' THEN TRUE
        WHEN lower(Coping_Struggles) = 'no' THEN FALSE
        ELSE NULL
    END as Coping_Struggles,
    CASE
        WHEN lower(Work_Interest) = 'yes' THEN TRUE
        WHEN lower(Work_Interest) = 'no' THEN FALSE
        ELSE NULL
    END as Work_Interest,
    CASE
        WHEN lower(Social_Weakness) = 'yes' THEN TRUE
        WHEN lower(Social_Weakness) = 'no' THEN FALSE
        ELSE NULL
    END as Social_Weakness,
    mental_health_interview,
    care_options
FROM raw_mental_health
  );

[0m14:11:20.149022 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:11:20.158849 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m14:11:20.159814 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
alter view "mental_health"."main"."stg_mental_health" rename to "stg_mental_health__dbt_backup"
[0m14:11:20.162837 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:11:20.166794 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m14:11:20.167791 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
alter view "mental_health"."main"."stg_mental_health__dbt_tmp" rename to "stg_mental_health"
[0m14:11:20.167791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:11:20.193002 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: COMMIT
[0m14:11:20.193002 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m14:11:20.193999 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: COMMIT
[0m14:11:20.373050 [debug] [Thread-1 (]: SQL status: OK in 0.179 seconds
[0m14:11:20.382494 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m14:11:20.382494 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
drop view if exists "mental_health"."main"."stg_mental_health__dbt_backup" cascade
[0m14:11:20.841229 [debug] [Thread-1 (]: SQL status: OK in 0.458 seconds
[0m14:11:20.844863 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: Close
[0m14:11:20.847298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a7a89a-2487-438c-9465-c50330924350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A12CF890>]}
[0m14:11:20.848302 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_mental_health ........................ [[32mOK[0m in 0.77s]
[0m14:11:20.848952 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.stg_mental_health
[0m14:11:20.850499 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.dim_geography
[0m14:11:20.850499 [info ] [Thread-1 (]: 2 of 3 START sql table model main.dim_geography ................................ [RUN]
[0m14:11:20.851775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mental_health_analytics.stg_mental_health, now model.mental_health_analytics.dim_geography)
[0m14:11:20.851775 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.dim_geography
[0m14:11:20.856338 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.dim_geography"
[0m14:11:20.857710 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.dim_geography
[0m14:11:20.887039 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.dim_geography"
[0m14:11:20.888037 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m14:11:20.889618 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: BEGIN
[0m14:11:20.889618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:20.890624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:20.890624 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m14:11:20.891621 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */

  
    
    

    create  table
      "mental_health"."main"."dim_geography__dbt_tmp"
  
    as (
      

SELECT
    ROW_NUMBER() OVER () as geography_id,
    Country,
    COUNT(*) as records_count
FROM "mental_health"."main"."stg_mental_health"
GROUP BY Country
    );
  
  
[0m14:11:21.475924 [debug] [Thread-1 (]: SQL status: OK in 0.584 seconds
[0m14:11:21.479912 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m14:11:21.480909 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
alter table "mental_health"."main"."dim_geography" rename to "dim_geography__dbt_backup"
[0m14:11:21.482908 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:21.486405 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m14:11:21.487402 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
alter table "mental_health"."main"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m14:11:21.488400 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:11:21.495797 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: COMMIT
[0m14:11:21.496793 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m14:11:21.496793 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: COMMIT
[0m14:11:21.533282 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m14:11:21.537276 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m14:11:21.537276 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
drop table if exists "mental_health"."main"."dim_geography__dbt_backup" cascade
[0m14:11:21.581279 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m14:11:21.584273 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: Close
[0m14:11:21.585270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a7a89a-2487-438c-9465-c50330924350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A549F2F0>]}
[0m14:11:21.586267 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.dim_geography ........................... [[32mOK[0m in 0.73s]
[0m14:11:21.587264 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.dim_geography
[0m14:11:21.589084 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.fact_mental_health
[0m14:11:21.589084 [info ] [Thread-1 (]: 3 of 3 START sql table model main.fact_mental_health ........................... [RUN]
[0m14:11:21.590085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mental_health_analytics.dim_geography, now model.mental_health_analytics.fact_mental_health)
[0m14:11:21.591086 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.fact_mental_health
[0m14:11:21.596073 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.fact_mental_health"
[0m14:11:21.597070 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.fact_mental_health
[0m14:11:21.604084 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.fact_mental_health"
[0m14:11:21.605049 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m14:11:21.605049 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: BEGIN
[0m14:11:21.606081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:21.606621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:21.607655 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m14:11:21.607655 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */

  
    
    

    create  table
      "mental_health"."main"."fact_mental_health__dbt_tmp"
  
    as (
      

WITH geography AS (
    SELECT * FROM "mental_health"."main"."dim_geography"
)

SELECT
    m.Timestamp,
    EXTRACT(YEAR FROM m.Timestamp) as year,
    EXTRACT(MONTH FROM m.Timestamp) as month,
    m.Gender,
    g.geography_id,
    m.Occupation,
    m.self_employed,
    m.family_history,
    m.treatment,
    m.Days_Indoors,
    m.Growing_Stress,
    m.Changes_Habits,
    m.Mental_Health_History,
    m.Mood_Swings,
    m.Coping_Struggles,
    m.Work_Interest,
    m.Social_Weakness,
    CASE
        WHEN lower(m.mental_health_interview) = 'yes' THEN TRUE
        WHEN lower(m.mental_health_interview) = 'no' THEN FALSE
        WHEN lower(m.mental_health_interview) = 'maybe' THEN NULL
        ELSE NULL
    END as mental_health_interview,
    CASE
        WHEN lower(m.care_options) = 'yes' THEN TRUE
        WHEN lower(m.care_options) = 'no' THEN FALSE
        WHEN lower(m.care_options) = 'not sure' THEN NULL
        ELSE NULL
    END as care_options
FROM "mental_health"."main"."stg_mental_health" m
JOIN geography g ON m.Country = g.Country
    );
  
  
[0m14:11:21.691154 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m14:11:21.695179 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m14:11:21.695179 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
alter table "mental_health"."main"."fact_mental_health" rename to "fact_mental_health__dbt_backup"
[0m14:11:21.696180 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:11:21.700171 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m14:11:21.701169 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
alter table "mental_health"."main"."fact_mental_health__dbt_tmp" rename to "fact_mental_health"
[0m14:11:21.703127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:21.705153 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: COMMIT
[0m14:11:21.705153 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m14:11:21.706150 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: COMMIT
[0m14:11:21.726999 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m14:11:21.729991 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m14:11:21.731741 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
drop table if exists "mental_health"."main"."fact_mental_health__dbt_backup" cascade
[0m14:11:21.741787 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m14:11:21.743815 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: Close
[0m14:11:21.744812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70a7a89a-2487-438c-9465-c50330924350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A55DC170>]}
[0m14:11:21.744812 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.fact_mental_health ...................... [[32mOK[0m in 0.15s]
[0m14:11:21.745810 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.fact_mental_health
[0m14:11:21.747771 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:21.748805 [debug] [MainThread]: On master: BEGIN
[0m14:11:21.748805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:21.749799 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:11:21.749799 [debug] [MainThread]: On master: COMMIT
[0m14:11:21.750797 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:21.750797 [debug] [MainThread]: On master: COMMIT
[0m14:11:21.751761 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:21.751761 [debug] [MainThread]: On master: Close
[0m14:11:21.751761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:21.752791 [debug] [MainThread]: Connection 'create_mental_health_main' was properly closed.
[0m14:11:21.752791 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m14:11:21.753788 [debug] [MainThread]: Connection 'model.mental_health_analytics.fact_mental_health' was properly closed.
[0m14:11:21.753788 [info ] [MainThread]: 
[0m14:11:21.754714 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m14:11:21.756335 [debug] [MainThread]: Command end result
[0m14:11:21.795145 [info ] [MainThread]: 
[0m14:11:21.796152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:21.797171 [info ] [MainThread]: 
[0m14:11:21.798206 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:11:21.799625 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:21.798624 after 3.43 seconds
[0m14:11:21.799625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A2D54B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A2C27F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A372C260>]}
[0m14:11:21.800621 [debug] [MainThread]: Flushing usage events
[0m14:11:37.152273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF91370E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFB698350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFB698F50>]}


============================== 14:11:37.156265 | f3d7ef73-0bc4-4322-abc8-6d925cffc9a1 ==============================
[0m14:11:37.156265 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:11:37.157383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:37.662601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3d7ef73-0bc4-4322-abc8-6d925cffc9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFC057DD0>]}
[0m14:11:37.815398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3d7ef73-0bc4-4322-abc8-6d925cffc9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFBB67FE0>]}
[0m14:11:37.821891 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m14:11:37.833625 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:11:38.049113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:38.063154 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:38.128366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3d7ef73-0bc4-4322-abc8-6d925cffc9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFBFE0BF0>]}
[0m14:11:38.343943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3d7ef73-0bc4-4322-abc8-6d925cffc9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFD6BC800>]}
[0m14:11:38.343943 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m14:11:38.345251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d7ef73-0bc4-4322-abc8-6d925cffc9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFD674110>]}
[0m14:11:38.348960 [info ] [MainThread]: 
[0m14:11:38.350039 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:11:38.358622 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m14:11:38.486710 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m14:11:38.487217 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m14:11:38.488223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:38.506596 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m14:11:38.506596 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m14:11:38.507593 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m14:11:38.537128 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m14:11:38.539156 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m14:11:38.542144 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m14:11:38.543176 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m14:11:38.545676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d7ef73-0bc4-4322-abc8-6d925cffc9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFD5007A0>]}
[0m14:11:38.546714 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:38.546714 [debug] [MainThread]: On master: BEGIN
[0m14:11:38.547675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:38.547675 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:11:38.548672 [debug] [MainThread]: On master: COMMIT
[0m14:11:38.548672 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:38.549669 [debug] [MainThread]: On master: COMMIT
[0m14:11:38.549669 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:38.550666 [debug] [MainThread]: On master: Close
[0m14:11:38.550666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:38.551672 [info ] [MainThread]: 
[0m14:11:38.555504 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m14:11:38.555504 [info ] [Thread-1 (]: 1 of 6 START test not_null_dim_geography_Country ............................... [RUN]
[0m14:11:38.556774 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535'
[0m14:11:38.556774 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m14:11:38.589319 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m14:11:38.591354 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m14:11:38.614372 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m14:11:38.616371 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m14:11:38.616876 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: BEGIN
[0m14:11:38.616876 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:11:38.617876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:38.618874 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m14:11:38.618874 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Country
from "mental_health"."main"."dim_geography"
where Country is null



      
    ) dbt_internal_test
[0m14:11:38.632159 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m14:11:38.638703 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: ROLLBACK
[0m14:11:38.641249 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535'
[0m14:11:38.641249 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: Close
[0m14:11:38.642251 [info ] [Thread-1 (]: 1 of 6 PASS not_null_dim_geography_Country ..................................... [[32mPASS[0m in 0.09s]
[0m14:11:38.643177 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m14:11:38.644180 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m14:11:38.644180 [info ] [Thread-1 (]: 2 of 6 START test not_null_dim_geography_geography_id .......................... [RUN]
[0m14:11:38.645177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535, now test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0)
[0m14:11:38.646172 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m14:11:38.651457 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m14:11:38.653456 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m14:11:38.656480 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m14:11:38.658445 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m14:11:38.658445 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: BEGIN
[0m14:11:38.659473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:38.659473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:38.660472 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m14:11:38.660472 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."dim_geography"
where geography_id is null



      
    ) dbt_internal_test
[0m14:11:38.662432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:38.664459 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: ROLLBACK
[0m14:11:38.666459 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0'
[0m14:11:38.666459 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: Close
[0m14:11:38.667418 [info ] [Thread-1 (]: 2 of 6 PASS not_null_dim_geography_geography_id ................................ [[32mPASS[0m in 0.02s]
[0m14:11:38.668415 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m14:11:38.669414 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m14:11:38.670416 [info ] [Thread-1 (]: 3 of 6 START test not_null_fact_mental_health_Timestamp ........................ [RUN]
[0m14:11:38.671496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0, now test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f)
[0m14:11:38.672504 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m14:11:38.679591 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m14:11:38.681584 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m14:11:38.685407 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m14:11:38.686522 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m14:11:38.687523 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: BEGIN
[0m14:11:38.687523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:38.688519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:38.689516 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m14:11:38.689516 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Timestamp
from "mental_health"."main"."fact_mental_health"
where Timestamp is null



      
    ) dbt_internal_test
[0m14:11:38.690514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:38.692508 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: ROLLBACK
[0m14:11:38.693506 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f'
[0m14:11:38.695598 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: Close
[0m14:11:38.696766 [info ] [Thread-1 (]: 3 of 6 PASS not_null_fact_mental_health_Timestamp .............................. [[32mPASS[0m in 0.02s]
[0m14:11:38.698343 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m14:11:38.700020 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m14:11:38.701872 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_mental_health_geography_id ..................... [RUN]
[0m14:11:38.702376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f, now test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474)
[0m14:11:38.703390 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m14:11:38.710216 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m14:11:38.711234 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m14:11:38.715245 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m14:11:38.717758 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m14:11:38.717758 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: BEGIN
[0m14:11:38.718755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:38.718755 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:38.719751 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m14:11:38.719751 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."fact_mental_health"
where geography_id is null



      
    ) dbt_internal_test
[0m14:11:38.721746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:38.723740 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: ROLLBACK
[0m14:11:38.725311 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474'
[0m14:11:38.725311 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: Close
[0m14:11:38.726313 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_mental_health_geography_id ........................... [[32mPASS[0m in 0.02s]
[0m14:11:38.727260 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m14:11:38.729273 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m14:11:38.730256 [info ] [Thread-1 (]: 5 of 6 START test relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_  [RUN]
[0m14:11:38.731255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474, now test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30)
[0m14:11:38.732255 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m14:11:38.747974 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m14:11:38.748955 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m14:11:38.751946 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m14:11:38.753942 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m14:11:38.753942 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: BEGIN
[0m14:11:38.754939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:38.754939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:38.755935 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m14:11:38.756933 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select geography_id as from_field
    from "mental_health"."main"."fact_mental_health"
    where geography_id is not null
),

parent as (
    select geography_id as to_field
    from "mental_health"."main"."dim_geography"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:11:38.760455 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:11:38.764458 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: ROLLBACK
[0m14:11:38.766477 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30'
[0m14:11:38.767442 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: Close
[0m14:11:38.767442 [info ] [Thread-1 (]: 5 of 6 PASS relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_  [[32mPASS[0m in 0.04s]
[0m14:11:38.768672 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m14:11:38.769711 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m14:11:38.769711 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_geography_geography_id ............................ [RUN]
[0m14:11:38.770898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30, now test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10)
[0m14:11:38.771902 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m14:11:38.785485 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m14:11:38.786487 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m14:11:38.789483 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m14:11:38.791479 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m14:11:38.791479 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: BEGIN
[0m14:11:38.792475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:38.792475 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:11:38.793472 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m14:11:38.794535 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    geography_id as unique_field,
    count(*) as n_records

from "mental_health"."main"."dim_geography"
where geography_id is not null
group by geography_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:11:38.820061 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m14:11:38.822059 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: ROLLBACK
[0m14:11:38.824054 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10'
[0m14:11:38.824054 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: Close
[0m14:11:38.825084 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_geography_geography_id .................................. [[32mPASS[0m in 0.05s]
[0m14:11:38.826083 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m14:11:38.828044 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:38.828044 [debug] [MainThread]: On master: BEGIN
[0m14:11:38.829043 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:38.830039 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:11:38.830039 [debug] [MainThread]: On master: COMMIT
[0m14:11:38.830039 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:38.831068 [debug] [MainThread]: On master: COMMIT
[0m14:11:38.831068 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:11:38.832065 [debug] [MainThread]: On master: Close
[0m14:11:38.832065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:38.833061 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m14:11:38.833061 [debug] [MainThread]: Connection 'test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10' was properly closed.
[0m14:11:38.833061 [info ] [MainThread]: 
[0m14:11:38.834060 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:11:38.837021 [debug] [MainThread]: Command end result
[0m14:11:38.878300 [info ] [MainThread]: 
[0m14:11:38.879297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:38.880297 [info ] [MainThread]: 
[0m14:11:38.881622 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:11:38.883419 [debug] [MainThread]: Command `dbt test` succeeded at 14:11:38.883419 after 1.91 seconds
[0m14:11:38.883419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFAF808F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFAF815E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFAF81400>]}
[0m14:11:38.884416 [debug] [MainThread]: Flushing usage events
[0m15:50:15.502125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319D421040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319D422570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319D420FB0>]}


============================== 15:50:15.584054 | 6a8ad678-6377-4ecd-a403-6c8e7f99e2ac ==============================
[0m15:50:15.584054 [info ] [MainThread]: Running with dbt=1.8.8
[0m15:50:15.584911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:50:22.912724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a8ad678-6377-4ecd-a403-6c8e7f99e2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319DC08B00>]}
[0m15:50:24.305951 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:50:24.306915 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:50:24.633211 [debug] [MainThread]: Command `dbt deps` succeeded at 15:50:24.309054 after 9.03 seconds
[0m15:50:24.633717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319DBD0EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319DE4C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319CCED940>]}
[0m15:50:24.634756 [debug] [MainThread]: Flushing usage events
[0m15:50:34.893317 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:50:54.084838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F1049CD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F104CCBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0F9CFE00>]}


============================== 15:50:54.088830 | 3210d55f-bb83-4281-919c-cb3216823dd6 ==============================
[0m15:50:54.088830 [info ] [MainThread]: Running with dbt=1.8.8
[0m15:50:54.089916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:50:55.117468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3210d55f-bb83-4281-919c-cb3216823dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F105F07D0>]}
[0m15:50:55.429491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3210d55f-bb83-4281-919c-cb3216823dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0F632A80>]}
[0m15:50:55.436095 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m15:50:55.450309 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m15:50:56.422754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:56.422754 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:56.525034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3210d55f-bb83-4281-919c-cb3216823dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F1080E3F0>]}
[0m15:50:56.761391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3210d55f-bb83-4281-919c-cb3216823dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F10AE5A90>]}
[0m15:50:56.762397 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m15:50:56.763081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3210d55f-bb83-4281-919c-cb3216823dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F108EACF0>]}
[0m15:50:56.766781 [info ] [MainThread]: 
[0m15:50:56.767672 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:50:56.790002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health'
[0m15:50:57.735623 [debug] [ThreadPool]: Using duckdb connection "list_mental_health"
[0m15:50:57.736620 [debug] [ThreadPool]: On list_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"mental_health"'
    
  
  
[0m15:50:57.736620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:58.226939 [debug] [ThreadPool]: SQL status: OK in 0.490 seconds
[0m15:50:58.280123 [debug] [ThreadPool]: On list_mental_health: Close
[0m15:50:58.281119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mental_health, now create_mental_health_main)
[0m15:50:58.312332 [debug] [ThreadPool]: Creating schema "database: "mental_health"
schema: "main"
"
[0m15:50:58.322752 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m15:50:58.323749 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='mental_health'
        and type='sqlite'
    
  
[0m15:50:58.323749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:58.324746 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:50:58.326741 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m15:50:58.327738 [debug] [ThreadPool]: On create_mental_health_main: BEGIN
[0m15:50:58.327738 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:50:58.327738 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m15:50:58.327738 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
    
        create schema if not exists "mental_health"."main"
    
[0m15:50:58.469541 [debug] [ThreadPool]: SQL status: OK in 0.140 seconds
[0m15:50:58.470544 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m15:50:58.471538 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m15:50:58.471538 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m15:50:58.472536 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:50:58.472536 [debug] [ThreadPool]: On create_mental_health_main: Close
[0m15:50:58.474783 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m15:50:58.484208 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m15:50:58.484208 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m15:50:58.485204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:58.485204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:50:58.486202 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m15:50:58.486202 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m15:50:58.611349 [debug] [ThreadPool]: SQL status: OK in 0.124 seconds
[0m15:50:58.617962 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m15:50:58.622550 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m15:50:58.623578 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m15:50:58.625091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3210d55f-bb83-4281-919c-cb3216823dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F11FFF1A0>]}
[0m15:50:58.626009 [debug] [MainThread]: Using duckdb connection "master"
[0m15:50:58.626554 [debug] [MainThread]: On master: BEGIN
[0m15:50:58.627180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:58.628212 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:50:58.628212 [debug] [MainThread]: On master: COMMIT
[0m15:50:58.628212 [debug] [MainThread]: Using duckdb connection "master"
[0m15:50:58.628212 [debug] [MainThread]: On master: COMMIT
[0m15:50:58.629726 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:50:58.629726 [debug] [MainThread]: On master: Close
[0m15:50:58.630742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:58.631417 [info ] [MainThread]: 
[0m15:50:58.673570 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.stg_mental_health
[0m15:50:58.674571 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_mental_health ............................. [RUN]
[0m15:50:58.674896 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.mental_health_analytics.stg_mental_health'
[0m15:50:58.675899 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.stg_mental_health
[0m15:50:58.686728 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.stg_mental_health"
[0m15:50:58.700196 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.stg_mental_health
[0m15:50:58.758551 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.stg_mental_health"
[0m15:50:58.766414 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m15:50:58.766414 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: BEGIN
[0m15:50:58.767408 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:58.767408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:50:58.768405 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m15:50:58.769402 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */

  
  create view "mental_health"."main"."stg_mental_health__dbt_tmp" as (
    

SELECT
    Timestamp,
    Gender,
    Country,
    Occupation,
    self_employed,
    CASE
        WHEN lower(family_history) = 'yes' THEN TRUE
        WHEN lower(family_history) = 'no' THEN FALSE
        ELSE NULL
    END as family_history,
    CASE
        WHEN lower(treatment) = 'yes' THEN TRUE
        WHEN lower(treatment) = 'no' THEN FALSE
        ELSE NULL
    END as treatment,
    Days_Indoors,
    CASE
        WHEN lower(Growing_Stress) = 'yes' THEN TRUE
        WHEN lower(Growing_Stress) = 'no' THEN FALSE
        ELSE NULL
    END as Growing_Stress,
    CASE
        WHEN lower(Changes_Habits) = 'yes' THEN TRUE
        WHEN lower(Changes_Habits) = 'no' THEN FALSE
        ELSE NULL
    END as Changes_Habits,
    CASE
        WHEN lower(Mental_Health_History) = 'yes' THEN TRUE
        WHEN lower(Mental_Health_History) = 'no' THEN FALSE
        ELSE NULL
    END as Mental_Health_History,
    Mood_Swings,
    CASE
        WHEN lower(Coping_Struggles) = 'yes' THEN TRUE
        WHEN lower(Coping_Struggles) = 'no' THEN FALSE
        ELSE NULL
    END as Coping_Struggles,
    CASE
        WHEN lower(Work_Interest) = 'yes' THEN TRUE
        WHEN lower(Work_Interest) = 'no' THEN FALSE
        ELSE NULL
    END as Work_Interest,
    CASE
        WHEN lower(Social_Weakness) = 'yes' THEN TRUE
        WHEN lower(Social_Weakness) = 'no' THEN FALSE
        ELSE NULL
    END as Social_Weakness,
    mental_health_interview,
    care_options
FROM raw_mental_health
  );

[0m15:50:58.802400 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */

  
  create view "mental_health"."main"."stg_mental_health__dbt_tmp" as (
    

SELECT
    Timestamp,
    Gender,
    Country,
    Occupation,
    self_employed,
    CASE
        WHEN lower(family_history) = 'yes' THEN TRUE
        WHEN lower(family_history) = 'no' THEN FALSE
        ELSE NULL
    END as family_history,
    CASE
        WHEN lower(treatment) = 'yes' THEN TRUE
        WHEN lower(treatment) = 'no' THEN FALSE
        ELSE NULL
    END as treatment,
    Days_Indoors,
    CASE
        WHEN lower(Growing_Stress) = 'yes' THEN TRUE
        WHEN lower(Growing_Stress) = 'no' THEN FALSE
        ELSE NULL
    END as Growing_Stress,
    CASE
        WHEN lower(Changes_Habits) = 'yes' THEN TRUE
        WHEN lower(Changes_Habits) = 'no' THEN FALSE
        ELSE NULL
    END as Changes_Habits,
    CASE
        WHEN lower(Mental_Health_History) = 'yes' THEN TRUE
        WHEN lower(Mental_Health_History) = 'no' THEN FALSE
        ELSE NULL
    END as Mental_Health_History,
    Mood_Swings,
    CASE
        WHEN lower(Coping_Struggles) = 'yes' THEN TRUE
        WHEN lower(Coping_Struggles) = 'no' THEN FALSE
        ELSE NULL
    END as Coping_Struggles,
    CASE
        WHEN lower(Work_Interest) = 'yes' THEN TRUE
        WHEN lower(Work_Interest) = 'no' THEN FALSE
        ELSE NULL
    END as Work_Interest,
    CASE
        WHEN lower(Social_Weakness) = 'yes' THEN TRUE
        WHEN lower(Social_Weakness) = 'no' THEN FALSE
        ELSE NULL
    END as Social_Weakness,
    mental_health_interview,
    care_options
FROM raw_mental_health
  );

[0m15:50:58.803405 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:50:58.804399 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: ROLLBACK
[0m15:50:58.962233 [debug] [Thread-1 (]: Failed to rollback 'model.mental_health_analytics.stg_mental_health'
[0m15:50:58.963234 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: Close
[0m15:50:58.976201 [debug] [Thread-1 (]: Runtime Error in model stg_mental_health (models\staging\stg_mental_health.sql)
  Binder Error: No function matches the given name and argument types 'lower(BOOLEAN)'. You might need to add explicit type casts.
  	Candidate functions:
  	lower(VARCHAR) -> VARCHAR
  
  
  LINE 14:         WHEN lower(family_history) = 'yes' THEN TRUE
                        ^
[0m15:50:58.978227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3210d55f-bb83-4281-919c-cb3216823dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FCE2F60>]}
[0m15:50:58.979191 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_mental_health .................... [[31mERROR[0m in 0.30s]
[0m15:50:58.980188 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.stg_mental_health
[0m15:50:58.983376 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.dim_geography
[0m15:50:58.984410 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.dim_geography ........................................ [[33mSKIP[0m]
[0m15:50:58.985214 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.dim_geography
[0m15:50:58.985999 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.fact_mental_health
[0m15:50:58.987002 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.fact_mental_health ................................... [[33mSKIP[0m]
[0m15:50:58.987519 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.fact_mental_health
[0m15:50:58.988517 [debug] [MainThread]: Using duckdb connection "master"
[0m15:50:58.989553 [debug] [MainThread]: On master: BEGIN
[0m15:50:58.989553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:58.990547 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:50:58.990547 [debug] [MainThread]: On master: COMMIT
[0m15:50:58.991544 [debug] [MainThread]: Using duckdb connection "master"
[0m15:50:58.991544 [debug] [MainThread]: On master: COMMIT
[0m15:50:58.992510 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:50:58.992510 [debug] [MainThread]: On master: Close
[0m15:50:58.993540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:58.993540 [debug] [MainThread]: Connection 'create_mental_health_main' was properly closed.
[0m15:50:58.993540 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m15:50:58.994535 [debug] [MainThread]: Connection 'model.mental_health_analytics.stg_mental_health' was properly closed.
[0m15:50:58.994535 [info ] [MainThread]: 
[0m15:50:58.995534 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m15:50:58.996499 [debug] [MainThread]: Command end result
[0m15:50:59.074161 [info ] [MainThread]: 
[0m15:50:59.075162 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:59.076435 [info ] [MainThread]: 
[0m15:50:59.077051 [error] [MainThread]:   Runtime Error in model stg_mental_health (models\staging\stg_mental_health.sql)
  Binder Error: No function matches the given name and argument types 'lower(BOOLEAN)'. You might need to add explicit type casts.
  	Candidate functions:
  	lower(VARCHAR) -> VARCHAR
  
  
  LINE 14:         WHEN lower(family_history) = 'yes' THEN TRUE
                        ^
[0m15:50:59.078051 [info ] [MainThread]: 
[0m15:50:59.078051 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m15:50:59.079553 [debug] [MainThread]: Command `dbt run` failed at 15:50:59.079553 after 5.18 seconds
[0m15:50:59.080553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F1049E300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F1049CA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F1049DAF0>]}
[0m15:50:59.080553 [debug] [MainThread]: Flushing usage events
[0m15:51:11.145823 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:51:51.180629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D682A780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D8F33AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D8F31220>]}


============================== 15:51:51.184616 | 342f8f17-38ad-47af-8773-3a29c4526660 ==============================
[0m15:51:51.184616 [info ] [MainThread]: Running with dbt=1.8.8
[0m15:51:51.186300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:51:51.679652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '342f8f17-38ad-47af-8773-3a29c4526660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D98B5F40>]}
[0m15:51:51.833147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '342f8f17-38ad-47af-8773-3a29c4526660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D9915D90>]}
[0m15:51:51.839752 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m15:51:51.852941 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m15:51:52.080953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:52.081956 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:52.146214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '342f8f17-38ad-47af-8773-3a29c4526660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D9A8FEC0>]}
[0m15:51:53.819795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '342f8f17-38ad-47af-8773-3a29c4526660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2DAE4C980>]}
[0m15:51:53.820799 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m15:51:53.821795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '342f8f17-38ad-47af-8773-3a29c4526660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D9ABC5C0>]}
[0m15:51:53.825411 [info ] [MainThread]: 
[0m15:51:53.826468 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:51:53.835049 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m15:51:53.964650 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m15:51:53.965647 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m15:51:53.965647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:53.986633 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m15:51:53.987630 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m15:51:53.987630 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m15:51:54.017274 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m15:51:54.019271 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m15:51:54.022805 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m15:51:54.022805 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m15:51:54.024917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '342f8f17-38ad-47af-8773-3a29c4526660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2DAC863C0>]}
[0m15:51:54.025472 [debug] [MainThread]: Using duckdb connection "master"
[0m15:51:54.026533 [debug] [MainThread]: On master: BEGIN
[0m15:51:54.027135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:54.028247 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:51:54.028752 [debug] [MainThread]: On master: COMMIT
[0m15:51:54.029274 [debug] [MainThread]: Using duckdb connection "master"
[0m15:51:54.029274 [debug] [MainThread]: On master: COMMIT
[0m15:51:54.030275 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:51:54.030275 [debug] [MainThread]: On master: Close
[0m15:51:54.031271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:54.031766 [info ] [MainThread]: 
[0m15:51:54.035331 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m15:51:54.036334 [info ] [Thread-1 (]: 1 of 6 START test not_null_dim_geography_Country ............................... [RUN]
[0m15:51:54.037330 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535'
[0m15:51:54.037330 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m15:51:54.066244 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m15:51:54.067240 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m15:51:54.089669 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m15:51:54.293469 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m15:51:54.293469 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: BEGIN
[0m15:51:54.294464 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:51:54.294464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:51:54.295462 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m15:51:54.295462 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Country
from "mental_health"."main"."dim_geography"
where Country is null



      
    ) dbt_internal_test
[0m15:51:54.316301 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Country
from "mental_health"."main"."dim_geography"
where Country is null



      
    ) dbt_internal_test
[0m15:51:54.316301 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:51:54.317298 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: ROLLBACK
[0m15:51:54.368925 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535'
[0m15:51:54.368925 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: Close
[0m15:51:54.380832 [debug] [Thread-1 (]: Runtime Error in test not_null_dim_geography_Country (models\marts\schema.yml)
  Catalog Error: Table with name dim_geography does not exist!
  Did you mean "duckdb_constraints"?
  
  LINE 14: from "mental_health"."main"."dim_geography"
                ^
[0m15:51:54.381829 [error] [Thread-1 (]: 1 of 6 ERROR not_null_dim_geography_Country .................................... [[31mERROR[0m in 0.34s]
[0m15:51:54.382795 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m15:51:54.382795 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m15:51:54.383792 [info ] [Thread-1 (]: 2 of 6 START test not_null_dim_geography_geography_id .......................... [RUN]
[0m15:51:54.386158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535, now test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0)
[0m15:51:54.387159 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m15:51:54.393142 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m15:51:54.589470 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m15:51:54.593474 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m15:51:54.594472 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m15:51:54.594472 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: BEGIN
[0m15:51:54.595470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:54.595470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:51:54.596467 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m15:51:54.597498 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."dim_geography"
where geography_id is null



      
    ) dbt_internal_test
[0m15:51:54.603476 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."dim_geography"
where geography_id is null



      
    ) dbt_internal_test
[0m15:51:54.603476 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:51:54.604478 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: ROLLBACK
[0m15:51:54.616601 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0'
[0m15:51:54.617602 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: Close
[0m15:51:54.627886 [debug] [Thread-1 (]: Runtime Error in test not_null_dim_geography_geography_id (models\marts\schema.yml)
  Catalog Error: Table with name dim_geography does not exist!
  Did you mean "duckdb_constraints"?
  
  LINE 14: from "mental_health"."main"."dim_geography"
                ^
[0m15:51:54.629885 [error] [Thread-1 (]: 2 of 6 ERROR not_null_dim_geography_geography_id ............................... [[31mERROR[0m in 0.24s]
[0m15:51:54.630886 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m15:51:54.631880 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m15:51:54.631880 [info ] [Thread-1 (]: 3 of 6 START test not_null_fact_mental_health_Timestamp ........................ [RUN]
[0m15:51:54.632948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0, now test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f)
[0m15:51:54.632948 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m15:51:54.639593 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m15:51:54.640595 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m15:51:54.643586 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m15:51:54.842364 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m15:51:54.843366 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: BEGIN
[0m15:51:54.844362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:54.844362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:51:54.845359 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m15:51:54.845359 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Timestamp
from "mental_health"."main"."fact_mental_health"
where Timestamp is null



      
    ) dbt_internal_test
[0m15:51:54.852342 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Timestamp
from "mental_health"."main"."fact_mental_health"
where Timestamp is null



      
    ) dbt_internal_test
[0m15:51:54.852342 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:51:54.853340 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: ROLLBACK
[0m15:51:54.866509 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f'
[0m15:51:54.867511 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: Close
[0m15:51:54.877704 [debug] [Thread-1 (]: Runtime Error in test not_null_fact_mental_health_Timestamp (models\marts\schema.yml)
  Catalog Error: Table with name fact_mental_health does not exist!
  Did you mean "raw_mental_health"?
  
  LINE 14: from "mental_health"."main"."fact_mental_health"
                ^
[0m15:51:54.878732 [error] [Thread-1 (]: 3 of 6 ERROR not_null_fact_mental_health_Timestamp ............................. [[31mERROR[0m in 0.25s]
[0m15:51:54.879646 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m15:51:54.880649 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m15:51:54.880649 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_mental_health_geography_id ..................... [RUN]
[0m15:51:54.881646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f, now test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474)
[0m15:51:54.882643 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m15:51:54.888087 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m15:51:54.889089 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m15:51:54.893077 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m15:51:54.894075 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m15:51:54.895078 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: BEGIN
[0m15:51:54.895078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:54.896069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:51:54.896069 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m15:51:54.897066 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."fact_mental_health"
where geography_id is null



      
    ) dbt_internal_test
[0m15:51:54.903051 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."fact_mental_health"
where geography_id is null



      
    ) dbt_internal_test
[0m15:51:54.903051 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:51:54.904048 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: ROLLBACK
[0m15:51:54.916620 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474'
[0m15:51:54.917621 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: Close
[0m15:51:54.928176 [debug] [Thread-1 (]: Runtime Error in test not_null_fact_mental_health_geography_id (models\marts\schema.yml)
  Catalog Error: Table with name fact_mental_health does not exist!
  Did you mean "raw_mental_health"?
  
  LINE 14: from "mental_health"."main"."fact_mental_health"
                ^
[0m15:51:54.929177 [error] [Thread-1 (]: 4 of 6 ERROR not_null_fact_mental_health_geography_id .......................... [[31mERROR[0m in 0.05s]
[0m15:51:54.930176 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m15:51:54.930714 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m15:51:54.930714 [info ] [Thread-1 (]: 5 of 6 START test relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_  [RUN]
[0m15:51:54.932059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474, now test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30)
[0m15:51:54.932059 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m15:51:54.946421 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m15:51:54.948421 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m15:51:54.951411 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m15:51:54.953160 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m15:51:54.954163 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: BEGIN
[0m15:51:54.955158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:54.955158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:51:54.956156 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m15:51:54.957157 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select geography_id as from_field
    from "mental_health"."main"."fact_mental_health"
    where geography_id is not null
),

parent as (
    select geography_id as to_field
    from "mental_health"."main"."dim_geography"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:51:54.992523 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select geography_id as from_field
    from "mental_health"."main"."fact_mental_health"
    where geography_id is not null
),

parent as (
    select geography_id as to_field
    from "mental_health"."main"."dim_geography"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:51:54.993521 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:51:54.993521 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: ROLLBACK
[0m15:51:55.006262 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30'
[0m15:51:55.007263 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: Close
[0m15:51:55.018016 [debug] [Thread-1 (]: Runtime Error in test relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_ (models\marts\schema.yml)
  Catalog Error: Table with name fact_mental_health does not exist!
  Did you mean "raw_mental_health"?
  
  LINE 13:     from "mental_health"."main"."fact_mental_health"
                    ^
[0m15:51:55.019050 [error] [Thread-1 (]: 5 of 6 ERROR relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_  [[31mERROR[0m in 0.09s]
[0m15:51:55.020015 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m15:51:55.020015 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m15:51:55.021013 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_geography_geography_id ............................ [RUN]
[0m15:51:55.022010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30, now test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10)
[0m15:51:55.022010 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m15:51:55.034704 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m15:51:55.035664 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m15:51:55.038689 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m15:51:55.039685 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m15:51:55.040683 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: BEGIN
[0m15:51:55.040683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:55.041681 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:51:55.041681 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m15:51:55.042676 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    geography_id as unique_field,
    count(*) as n_records

from "mental_health"."main"."dim_geography"
where geography_id is not null
group by geography_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:51:55.149838 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    geography_id as unique_field,
    count(*) as n_records

from "mental_health"."main"."dim_geography"
where geography_id is not null
group by geography_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:51:55.150837 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:51:55.150837 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: ROLLBACK
[0m15:51:55.162862 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10'
[0m15:51:55.163863 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: Close
[0m15:51:55.176196 [debug] [Thread-1 (]: Runtime Error in test unique_dim_geography_geography_id (models\marts\schema.yml)
  Catalog Error: Table with name dim_geography does not exist!
  Did you mean "duckdb_constraints"?
  
  LINE 15: from "mental_health"."main"."dim_geography"
                ^
[0m15:51:55.177197 [error] [Thread-1 (]: 6 of 6 ERROR unique_dim_geography_geography_id ................................. [[31mERROR[0m in 0.16s]
[0m15:51:55.177837 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m15:51:55.179171 [debug] [MainThread]: Using duckdb connection "master"
[0m15:51:55.180172 [debug] [MainThread]: On master: BEGIN
[0m15:51:55.180172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:55.181209 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:51:55.182200 [debug] [MainThread]: On master: COMMIT
[0m15:51:55.182200 [debug] [MainThread]: Using duckdb connection "master"
[0m15:51:55.182200 [debug] [MainThread]: On master: COMMIT
[0m15:51:55.183197 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:51:55.183197 [debug] [MainThread]: On master: Close
[0m15:51:55.184194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:55.184194 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m15:51:55.185191 [debug] [MainThread]: Connection 'test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10' was properly closed.
[0m15:51:55.185191 [info ] [MainThread]: 
[0m15:51:55.186156 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m15:51:55.188784 [debug] [MainThread]: Command end result
[0m15:51:55.228466 [info ] [MainThread]: 
[0m15:51:55.229463 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m15:51:55.229463 [info ] [MainThread]: 
[0m15:51:55.230460 [error] [MainThread]:   Runtime Error in test not_null_dim_geography_Country (models\marts\schema.yml)
  Catalog Error: Table with name dim_geography does not exist!
  Did you mean "duckdb_constraints"?
  
  LINE 14: from "mental_health"."main"."dim_geography"
                ^
[0m15:51:55.231459 [info ] [MainThread]: 
[0m15:51:55.232086 [error] [MainThread]:   Runtime Error in test not_null_dim_geography_geography_id (models\marts\schema.yml)
  Catalog Error: Table with name dim_geography does not exist!
  Did you mean "duckdb_constraints"?
  
  LINE 14: from "mental_health"."main"."dim_geography"
                ^
[0m15:51:55.232735 [info ] [MainThread]: 
[0m15:51:55.234036 [error] [MainThread]:   Runtime Error in test not_null_fact_mental_health_Timestamp (models\marts\schema.yml)
  Catalog Error: Table with name fact_mental_health does not exist!
  Did you mean "raw_mental_health"?
  
  LINE 14: from "mental_health"."main"."fact_mental_health"
                ^
[0m15:51:55.235038 [info ] [MainThread]: 
[0m15:51:55.236034 [error] [MainThread]:   Runtime Error in test not_null_fact_mental_health_geography_id (models\marts\schema.yml)
  Catalog Error: Table with name fact_mental_health does not exist!
  Did you mean "raw_mental_health"?
  
  LINE 14: from "mental_health"."main"."fact_mental_health"
                ^
[0m15:51:55.237034 [info ] [MainThread]: 
[0m15:51:55.237615 [error] [MainThread]:   Runtime Error in test relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_ (models\marts\schema.yml)
  Catalog Error: Table with name fact_mental_health does not exist!
  Did you mean "raw_mental_health"?
  
  LINE 13:     from "mental_health"."main"."fact_mental_health"
                    ^
[0m15:51:55.238518 [info ] [MainThread]: 
[0m15:51:55.239297 [error] [MainThread]:   Runtime Error in test unique_dim_geography_geography_id (models\marts\schema.yml)
  Catalog Error: Table with name dim_geography does not exist!
  Did you mean "duckdb_constraints"?
  
  LINE 15: from "mental_health"."main"."dim_geography"
                ^
[0m15:51:55.240298 [info ] [MainThread]: 
[0m15:51:55.241298 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m15:51:55.242795 [debug] [MainThread]: Command `dbt test` failed at 15:51:55.242795 after 4.25 seconds
[0m15:51:55.242795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D682A780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D96A5D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D5E1E360>]}
[0m15:51:55.243793 [debug] [MainThread]: Flushing usage events
[0m15:52:06.278202 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:02:30.930525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F2EE73E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EF5FF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EF65DDC0>]}


============================== 16:02:30.934517 | 325b85d7-cb19-4386-86ba-f9bcc728898b ==============================
[0m16:02:30.934517 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:02:30.935515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:31.246582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '325b85d7-cb19-4386-86ba-f9bcc728898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F3093E00>]}
[0m16:02:31.277225 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:02:31.278189 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:02:31.280411 [debug] [MainThread]: Command `dbt deps` succeeded at 16:02:31.279410 after 0.57 seconds
[0m16:02:31.280411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F20FAD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F24F60F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F24F7FB0>]}
[0m16:02:31.281409 [debug] [MainThread]: Flushing usage events
[0m16:02:40.326788 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:02:49.612090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BD45A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BD8783B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BD87AAB0>]}


============================== 16:02:49.617083 | 88467f11-d9ae-4db3-a1e9-9687674954fd ==============================
[0m16:02:49.617083 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:02:49.617707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:02:50.120446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88467f11-d9ae-4db3-a1e9-9687674954fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BDD9A2D0>]}
[0m16:02:50.272501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88467f11-d9ae-4db3-a1e9-9687674954fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BDE44080>]}
[0m16:02:50.277993 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m16:02:50.291934 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:02:50.511428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:02:50.511428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:02:50.578296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88467f11-d9ae-4db3-a1e9-9687674954fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BDDDEBD0>]}
[0m16:02:50.722015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88467f11-d9ae-4db3-a1e9-9687674954fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BF2D5760>]}
[0m16:02:50.723014 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m16:02:50.723379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88467f11-d9ae-4db3-a1e9-9687674954fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BE0D5790>]}
[0m16:02:50.727016 [info ] [MainThread]: 
[0m16:02:50.727894 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:02:50.737983 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health'
[0m16:02:50.870501 [debug] [ThreadPool]: Using duckdb connection "list_mental_health"
[0m16:02:50.871497 [debug] [ThreadPool]: On list_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"mental_health"'
    
  
  
[0m16:02:50.871497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:50.892734 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:02:50.894731 [debug] [ThreadPool]: On list_mental_health: Close
[0m16:02:50.894731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mental_health, now create_mental_health_main)
[0m16:02:50.895729 [debug] [ThreadPool]: Creating schema "database: "mental_health"
schema: "main"
"
[0m16:02:50.906292 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m16:02:50.907289 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='mental_health'
        and type='sqlite'
    
  
[0m16:02:50.907289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:50.908286 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:02:50.910280 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m16:02:50.910280 [debug] [ThreadPool]: On create_mental_health_main: BEGIN
[0m16:02:50.911278 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:02:50.911278 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m16:02:50.912275 [debug] [ThreadPool]: On create_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "create_mental_health_main"} */

    
    
        create schema if not exists "mental_health"."main"
    
[0m16:02:50.912275 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:02:50.913776 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m16:02:50.914776 [debug] [ThreadPool]: Using duckdb connection "create_mental_health_main"
[0m16:02:50.914776 [debug] [ThreadPool]: On create_mental_health_main: COMMIT
[0m16:02:50.915774 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:02:50.915774 [debug] [ThreadPool]: On create_mental_health_main: Close
[0m16:02:50.917719 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m16:02:50.927147 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m16:02:50.927147 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m16:02:50.928144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:50.928144 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:02:50.929141 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m16:02:50.929141 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m16:02:50.960058 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m16:02:50.962053 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m16:02:50.965266 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m16:02:50.966297 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m16:02:50.968236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88467f11-d9ae-4db3-a1e9-9687674954fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BE074530>]}
[0m16:02:50.968236 [debug] [MainThread]: Using duckdb connection "master"
[0m16:02:50.969271 [debug] [MainThread]: On master: BEGIN
[0m16:02:50.969271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:50.970270 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:02:50.970270 [debug] [MainThread]: On master: COMMIT
[0m16:02:50.971265 [debug] [MainThread]: Using duckdb connection "master"
[0m16:02:50.971265 [debug] [MainThread]: On master: COMMIT
[0m16:02:50.972229 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:02:50.972229 [debug] [MainThread]: On master: Close
[0m16:02:50.973258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:50.973258 [info ] [MainThread]: 
[0m16:02:50.977338 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.stg_mental_health
[0m16:02:50.978339 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_mental_health ............................. [RUN]
[0m16:02:50.978788 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.mental_health_analytics.stg_mental_health'
[0m16:02:50.979789 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.stg_mental_health
[0m16:02:50.989811 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.stg_mental_health"
[0m16:02:50.990812 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.stg_mental_health
[0m16:02:51.048946 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.stg_mental_health"
[0m16:02:51.048946 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m16:02:51.050457 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: BEGIN
[0m16:02:51.051459 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:02:51.052456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:02:51.052456 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m16:02:51.053453 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */

  
  create view "mental_health"."main"."stg_mental_health__dbt_tmp" as (
    

SELECT
    Timestamp,
    Gender,
    Country,
    Occupation,
    self_employed,
    CASE
        WHEN lower(family_history) = 'yes' THEN TRUE
        WHEN lower(family_history) = 'no' THEN FALSE
        ELSE NULL
    END as family_history,
    CASE
        WHEN lower(treatment) = 'yes' THEN TRUE
        WHEN lower(treatment) = 'no' THEN FALSE
        ELSE NULL
    END as treatment,
    Days_Indoors,
    CASE
        WHEN lower(Growing_Stress) = 'yes' THEN TRUE
        WHEN lower(Growing_Stress) = 'no' THEN FALSE
        ELSE NULL
    END as Growing_Stress,
    CASE
        WHEN lower(Changes_Habits) = 'yes' THEN TRUE
        WHEN lower(Changes_Habits) = 'no' THEN FALSE
        ELSE NULL
    END as Changes_Habits,
    CASE
        WHEN lower(Mental_Health_History) = 'yes' THEN TRUE
        WHEN lower(Mental_Health_History) = 'no' THEN FALSE
        ELSE NULL
    END as Mental_Health_History,
    Mood_Swings,
    CASE
        WHEN lower(Coping_Struggles) = 'yes' THEN TRUE
        WHEN lower(Coping_Struggles) = 'no' THEN FALSE
        ELSE NULL
    END as Coping_Struggles,
    CASE
        WHEN lower(Work_Interest) = 'yes' THEN TRUE
        WHEN lower(Work_Interest) = 'no' THEN FALSE
        ELSE NULL
    END as Work_Interest,
    CASE
        WHEN lower(Social_Weakness) = 'yes' THEN TRUE
        WHEN lower(Social_Weakness) = 'no' THEN FALSE
        ELSE NULL
    END as Social_Weakness,
    mental_health_interview,
    care_options
FROM raw_mental_health
  );

[0m16:02:51.054451 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:02:51.066155 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m16:02:51.066155 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
alter view "mental_health"."main"."stg_mental_health" rename to "stg_mental_health__dbt_backup"
[0m16:02:51.121678 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m16:02:51.125667 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m16:02:51.126664 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
alter view "mental_health"."main"."stg_mental_health__dbt_tmp" rename to "stg_mental_health"
[0m16:02:51.126664 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:02:51.148945 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: COMMIT
[0m16:02:51.148945 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m16:02:51.149941 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: COMMIT
[0m16:02:51.476036 [debug] [Thread-1 (]: SQL status: OK in 0.325 seconds
[0m16:02:51.483644 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.stg_mental_health"
[0m16:02:51.484647 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.stg_mental_health"} */
drop view if exists "mental_health"."main"."stg_mental_health__dbt_backup" cascade
[0m16:02:51.549364 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m16:02:51.552909 [debug] [Thread-1 (]: On model.mental_health_analytics.stg_mental_health: Close
[0m16:02:51.555045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88467f11-d9ae-4db3-a1e9-9687674954fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BB5CF890>]}
[0m16:02:51.556047 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_mental_health ........................ [[32mOK[0m in 0.57s]
[0m16:02:51.556638 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.stg_mental_health
[0m16:02:51.557641 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.dim_geography
[0m16:02:51.558665 [info ] [Thread-1 (]: 2 of 3 START sql table model main.dim_geography ................................ [RUN]
[0m16:02:51.559636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mental_health_analytics.stg_mental_health, now model.mental_health_analytics.dim_geography)
[0m16:02:51.559636 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.dim_geography
[0m16:02:51.564078 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.dim_geography"
[0m16:02:51.565080 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.dim_geography
[0m16:02:51.594605 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.dim_geography"
[0m16:02:51.609139 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m16:02:51.609139 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: BEGIN
[0m16:02:51.610168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:51.611131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:02:51.611131 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m16:02:51.612162 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */

  
    
    

    create  table
      "mental_health"."main"."dim_geography__dbt_tmp"
  
    as (
      

SELECT
    ROW_NUMBER() OVER () as geography_id,
    Country,
    COUNT(*) as records_count
FROM "mental_health"."main"."stg_mental_health"
GROUP BY Country
    );
  
  
[0m16:02:51.793758 [debug] [Thread-1 (]: SQL status: OK in 0.182 seconds
[0m16:02:51.797752 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m16:02:51.798750 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
alter table "mental_health"."main"."dim_geography" rename to "dim_geography__dbt_backup"
[0m16:02:51.799750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:02:51.802742 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m16:02:51.803739 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
alter table "mental_health"."main"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m16:02:51.804737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:02:51.812419 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: COMMIT
[0m16:02:51.812419 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m16:02:51.813926 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: COMMIT
[0m16:02:51.842306 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m16:02:51.845328 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.dim_geography"
[0m16:02:51.845328 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.dim_geography"} */
drop table if exists "mental_health"."main"."dim_geography__dbt_backup" cascade
[0m16:02:51.887026 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m16:02:51.889028 [debug] [Thread-1 (]: On model.mental_health_analytics.dim_geography: Close
[0m16:02:51.890025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88467f11-d9ae-4db3-a1e9-9687674954fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BF80C5F0>]}
[0m16:02:51.890025 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.dim_geography ........................... [[32mOK[0m in 0.33s]
[0m16:02:51.891561 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.dim_geography
[0m16:02:51.892434 [debug] [Thread-1 (]: Began running node model.mental_health_analytics.fact_mental_health
[0m16:02:51.893437 [info ] [Thread-1 (]: 3 of 3 START sql table model main.fact_mental_health ........................... [RUN]
[0m16:02:51.893437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mental_health_analytics.dim_geography, now model.mental_health_analytics.fact_mental_health)
[0m16:02:51.894434 [debug] [Thread-1 (]: Began compiling node model.mental_health_analytics.fact_mental_health
[0m16:02:51.898817 [debug] [Thread-1 (]: Writing injected SQL for node "model.mental_health_analytics.fact_mental_health"
[0m16:02:51.916967 [debug] [Thread-1 (]: Began executing node model.mental_health_analytics.fact_mental_health
[0m16:02:51.922959 [debug] [Thread-1 (]: Writing runtime sql for node "model.mental_health_analytics.fact_mental_health"
[0m16:02:51.923957 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m16:02:51.924959 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: BEGIN
[0m16:02:51.924959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:51.925952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:02:51.926948 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m16:02:51.926948 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */

  
    
    

    create  table
      "mental_health"."main"."fact_mental_health__dbt_tmp"
  
    as (
      

WITH geography AS (
    SELECT * FROM "mental_health"."main"."dim_geography"
)

SELECT
    m.Timestamp,
    EXTRACT(YEAR FROM m.Timestamp) as year,
    EXTRACT(MONTH FROM m.Timestamp) as month,
    m.Gender,
    g.geography_id,
    m.Occupation,
    m.self_employed,
    m.family_history,
    m.treatment,
    m.Days_Indoors,
    m.Growing_Stress,
    m.Changes_Habits,
    m.Mental_Health_History,
    m.Mood_Swings,
    m.Coping_Struggles,
    m.Work_Interest,
    m.Social_Weakness,
    CASE
        WHEN lower(m.mental_health_interview) = 'yes' THEN TRUE
        WHEN lower(m.mental_health_interview) = 'no' THEN FALSE
        WHEN lower(m.mental_health_interview) = 'maybe' THEN NULL
        ELSE NULL
    END as mental_health_interview,
    CASE
        WHEN lower(m.care_options) = 'yes' THEN TRUE
        WHEN lower(m.care_options) = 'no' THEN FALSE
        WHEN lower(m.care_options) = 'not sure' THEN NULL
        ELSE NULL
    END as care_options
FROM "mental_health"."main"."stg_mental_health" m
JOIN geography g ON m.Country = g.Country
    );
  
  
[0m16:02:52.003144 [debug] [Thread-1 (]: SQL status: OK in 0.075 seconds
[0m16:02:52.007166 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m16:02:52.008132 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
alter table "mental_health"."main"."fact_mental_health" rename to "fact_mental_health__dbt_backup"
[0m16:02:52.009129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:02:52.013150 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m16:02:52.013150 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
alter table "mental_health"."main"."fact_mental_health__dbt_tmp" rename to "fact_mental_health"
[0m16:02:52.014154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:02:52.016450 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: COMMIT
[0m16:02:52.016450 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m16:02:52.017448 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: COMMIT
[0m16:02:52.058507 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m16:02:52.061519 [debug] [Thread-1 (]: Using duckdb connection "model.mental_health_analytics.fact_mental_health"
[0m16:02:52.062517 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "model.mental_health_analytics.fact_mental_health"} */
drop table if exists "mental_health"."main"."fact_mental_health__dbt_backup" cascade
[0m16:02:52.097159 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m16:02:52.099160 [debug] [Thread-1 (]: On model.mental_health_analytics.fact_mental_health: Close
[0m16:02:52.100161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88467f11-d9ae-4db3-a1e9-9687674954fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BF90FDA0>]}
[0m16:02:52.100161 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.fact_mental_health ...................... [[32mOK[0m in 0.21s]
[0m16:02:52.101281 [debug] [Thread-1 (]: Finished running node model.mental_health_analytics.fact_mental_health
[0m16:02:52.102543 [debug] [MainThread]: Using duckdb connection "master"
[0m16:02:52.103581 [debug] [MainThread]: On master: BEGIN
[0m16:02:52.103581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:52.104668 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:02:52.105173 [debug] [MainThread]: On master: COMMIT
[0m16:02:52.105173 [debug] [MainThread]: Using duckdb connection "master"
[0m16:02:52.106178 [debug] [MainThread]: On master: COMMIT
[0m16:02:52.106178 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:02:52.107176 [debug] [MainThread]: On master: Close
[0m16:02:52.107176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:52.108173 [debug] [MainThread]: Connection 'create_mental_health_main' was properly closed.
[0m16:02:52.108173 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m16:02:52.108173 [debug] [MainThread]: Connection 'model.mental_health_analytics.fact_mental_health' was properly closed.
[0m16:02:52.109170 [info ] [MainThread]: 
[0m16:02:52.109855 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m16:02:52.111468 [debug] [MainThread]: Command end result
[0m16:02:52.149603 [info ] [MainThread]: 
[0m16:02:52.150601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:52.150601 [info ] [MainThread]: 
[0m16:02:52.152596 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:02:52.155590 [debug] [MainThread]: Command `dbt run` succeeded at 16:02:52.154592 after 2.72 seconds
[0m16:02:52.155590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BAEE72F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BD13C2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244BDC6B3B0>]}
[0m16:02:52.156585 [debug] [MainThread]: Flushing usage events
[0m16:02:59.192583 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:03:13.658831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001942738D100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001942647E1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194295E3440>]}


============================== 16:03:13.662823 | c2659246-9f88-4fbc-bfd3-533892c53590 ==============================
[0m16:03:13.662823 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:03:13.664143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project', 'log_path': 'C:\\Users\\Admin\\downloads\\mental-health-de-zoomcamp\\dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:03:14.173159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2659246-9f88-4fbc-bfd3-533892c53590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019429F16B40>]}
[0m16:03:14.348215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2659246-9f88-4fbc-bfd3-533892c53590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019429ED8920>]}
[0m16:03:14.355197 [info ] [MainThread]: Registered adapter: duckdb=1.9.2
[0m16:03:14.368099 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:03:14.588072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:14.588072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:14.652393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2659246-9f88-4fbc-bfd3-533892c53590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001942A1DE030>]}
[0m16:03:14.832213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2659246-9f88-4fbc-bfd3-533892c53590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001942B56CBF0>]}
[0m16:03:14.833212 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m16:03:14.833598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2659246-9f88-4fbc-bfd3-533892c53590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001942B533440>]}
[0m16:03:14.837511 [info ] [MainThread]: 
[0m16:03:14.838594 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:03:14.846842 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_mental_health_main'
[0m16:03:14.975877 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m16:03:14.976874 [debug] [ThreadPool]: On list_mental_health_main: BEGIN
[0m16:03:14.976874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:14.995861 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:03:14.995861 [debug] [ThreadPool]: Using duckdb connection "list_mental_health_main"
[0m16:03:14.996854 [debug] [ThreadPool]: On list_mental_health_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "connection_name": "list_mental_health_main"} */
select
      'mental_health' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'mental_health'
  
[0m16:03:15.029245 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m16:03:15.031242 [debug] [ThreadPool]: On list_mental_health_main: ROLLBACK
[0m16:03:15.035267 [debug] [ThreadPool]: Failed to rollback 'list_mental_health_main'
[0m16:03:15.036229 [debug] [ThreadPool]: On list_mental_health_main: Close
[0m16:03:15.038603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2659246-9f88-4fbc-bfd3-533892c53590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019429529B80>]}
[0m16:03:15.038603 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:15.039639 [debug] [MainThread]: On master: BEGIN
[0m16:03:15.039639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:15.040635 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:03:15.040635 [debug] [MainThread]: On master: COMMIT
[0m16:03:15.041632 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:15.041632 [debug] [MainThread]: On master: COMMIT
[0m16:03:15.042629 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:03:15.042629 [debug] [MainThread]: On master: Close
[0m16:03:15.043662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:15.043662 [info ] [MainThread]: 
[0m16:03:15.047951 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m16:03:15.047951 [info ] [Thread-1 (]: 1 of 6 START test not_null_dim_geography_Country ............................... [RUN]
[0m16:03:15.048962 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535'
[0m16:03:15.049951 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m16:03:15.080082 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m16:03:15.081078 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m16:03:15.103456 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m16:03:15.105455 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m16:03:15.105455 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: BEGIN
[0m16:03:15.106452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:15.107449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:15.107449 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"
[0m16:03:15.108446 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Country
from "mental_health"."main"."dim_geography"
where Country is null



      
    ) dbt_internal_test
[0m16:03:15.140190 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m16:03:15.146591 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: ROLLBACK
[0m16:03:15.148139 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535'
[0m16:03:15.149102 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535: Close
[0m16:03:15.150099 [info ] [Thread-1 (]: 1 of 6 PASS not_null_dim_geography_Country ..................................... [[32mPASS[0m in 0.10s]
[0m16:03:15.150803 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535
[0m16:03:15.151807 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m16:03:15.151807 [info ] [Thread-1 (]: 2 of 6 START test not_null_dim_geography_geography_id .......................... [RUN]
[0m16:03:15.152803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_dim_geography_Country.5c88e1b535, now test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0)
[0m16:03:15.153801 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m16:03:15.159273 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m16:03:15.160274 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m16:03:15.164961 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m16:03:15.166007 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m16:03:15.166007 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: BEGIN
[0m16:03:15.167008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:15.168004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:15.168004 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"
[0m16:03:15.169002 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."dim_geography"
where geography_id is null



      
    ) dbt_internal_test
[0m16:03:15.170000 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:15.171993 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: ROLLBACK
[0m16:03:15.173828 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0'
[0m16:03:15.173828 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0: Close
[0m16:03:15.174830 [info ] [Thread-1 (]: 2 of 6 PASS not_null_dim_geography_geography_id ................................ [[32mPASS[0m in 0.02s]
[0m16:03:15.175742 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0
[0m16:03:15.176776 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m16:03:15.177741 [info ] [Thread-1 (]: 3 of 6 START test not_null_fact_mental_health_Timestamp ........................ [RUN]
[0m16:03:15.178741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_dim_geography_geography_id.2e590571d0, now test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f)
[0m16:03:15.179778 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m16:03:15.186862 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m16:03:15.187864 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m16:03:15.191852 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m16:03:15.192849 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m16:03:15.192849 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: BEGIN
[0m16:03:15.193848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:15.194847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:15.195874 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"
[0m16:03:15.195874 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Timestamp
from "mental_health"."main"."fact_mental_health"
where Timestamp is null



      
    ) dbt_internal_test
[0m16:03:15.196872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:15.198833 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: ROLLBACK
[0m16:03:15.200861 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f'
[0m16:03:15.201826 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f: Close
[0m16:03:15.202823 [info ] [Thread-1 (]: 3 of 6 PASS not_null_fact_mental_health_Timestamp .............................. [[32mPASS[0m in 0.02s]
[0m16:03:15.203236 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f
[0m16:03:15.204276 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m16:03:15.206060 [info ] [Thread-1 (]: 4 of 6 START test not_null_fact_mental_health_geography_id ..................... [RUN]
[0m16:03:15.206643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_fact_mental_health_Timestamp.a3dff7df3f, now test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474)
[0m16:03:15.207646 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m16:03:15.213817 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m16:03:15.215818 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m16:03:15.218808 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m16:03:15.219806 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m16:03:15.220804 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: BEGIN
[0m16:03:15.220804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:15.221800 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:15.222798 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"
[0m16:03:15.222798 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select geography_id
from "mental_health"."main"."fact_mental_health"
where geography_id is null



      
    ) dbt_internal_test
[0m16:03:15.224798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:15.226821 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: ROLLBACK
[0m16:03:15.227818 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474'
[0m16:03:15.229326 [debug] [Thread-1 (]: On test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474: Close
[0m16:03:15.229326 [info ] [Thread-1 (]: 4 of 6 PASS not_null_fact_mental_health_geography_id ........................... [[32mPASS[0m in 0.02s]
[0m16:03:15.230545 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474
[0m16:03:15.232558 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m16:03:15.233544 [info ] [Thread-1 (]: 5 of 6 START test relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_  [RUN]
[0m16:03:15.234598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.not_null_fact_mental_health_geography_id.addd9ee474, now test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30)
[0m16:03:15.235537 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m16:03:15.250920 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m16:03:15.252923 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m16:03:15.255916 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m16:03:15.256914 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m16:03:15.257912 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: BEGIN
[0m16:03:15.257912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:15.258911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:15.258911 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"
[0m16:03:15.259907 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select geography_id as from_field
    from "mental_health"."main"."fact_mental_health"
    where geography_id is not null
),

parent as (
    select geography_id as to_field
    from "mental_health"."main"."dim_geography"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:03:15.263423 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:03:15.265424 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: ROLLBACK
[0m16:03:15.268009 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30'
[0m16:03:15.268841 [debug] [Thread-1 (]: On test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30: Close
[0m16:03:15.269359 [info ] [Thread-1 (]: 5 of 6 PASS relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_  [[32mPASS[0m in 0.03s]
[0m16:03:15.271298 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30
[0m16:03:15.272348 [debug] [Thread-1 (]: Began running node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m16:03:15.273338 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_geography_geography_id ............................ [RUN]
[0m16:03:15.274302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mental_health_analytics.relationships_fact_mental_health_geography_id__geography_id__ref_dim_geography_.33708b0c30, now test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10)
[0m16:03:15.275332 [debug] [Thread-1 (]: Began compiling node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m16:03:15.288303 [debug] [Thread-1 (]: Writing injected SQL for node "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m16:03:15.289301 [debug] [Thread-1 (]: Began executing node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m16:03:15.292356 [debug] [Thread-1 (]: Writing runtime sql for node "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m16:03:15.293353 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m16:03:15.294352 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: BEGIN
[0m16:03:15.294352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:15.295348 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:15.295348 [debug] [Thread-1 (]: Using duckdb connection "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"
[0m16:03:15.296345 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "mental_health_duckdb", "target_name": "dev", "node_id": "test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    geography_id as unique_field,
    count(*) as n_records

from "mental_health"."main"."dim_geography"
where geography_id is not null
group by geography_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:15.318109 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m16:03:15.320115 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: ROLLBACK
[0m16:03:15.321790 [debug] [Thread-1 (]: Failed to rollback 'test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10'
[0m16:03:15.321790 [debug] [Thread-1 (]: On test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10: Close
[0m16:03:15.322792 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_geography_geography_id .................................. [[32mPASS[0m in 0.05s]
[0m16:03:15.323689 [debug] [Thread-1 (]: Finished running node test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10
[0m16:03:15.325690 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:15.325690 [debug] [MainThread]: On master: BEGIN
[0m16:03:15.326687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:15.326687 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:03:15.327684 [debug] [MainThread]: On master: COMMIT
[0m16:03:15.328192 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:15.328192 [debug] [MainThread]: On master: COMMIT
[0m16:03:15.329199 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:03:15.329199 [debug] [MainThread]: On master: Close
[0m16:03:15.330208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:15.330208 [debug] [MainThread]: Connection 'list_mental_health_main' was properly closed.
[0m16:03:15.330208 [debug] [MainThread]: Connection 'test.mental_health_analytics.unique_dim_geography_geography_id.d6065c8c10' was properly closed.
[0m16:03:15.331205 [info ] [MainThread]: 
[0m16:03:15.332201 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m16:03:15.336281 [debug] [MainThread]: Command end result
[0m16:03:15.379364 [info ] [MainThread]: 
[0m16:03:15.380362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:15.381613 [info ] [MainThread]: 
[0m16:03:15.382615 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:03:15.385076 [debug] [MainThread]: Command `dbt test` succeeded at 16:03:15.385076 after 1.91 seconds
[0m16:03:15.385076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019429D05C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019429D05A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019429D05BB0>]}
[0m16:03:15.386073 [debug] [MainThread]: Flushing usage events
